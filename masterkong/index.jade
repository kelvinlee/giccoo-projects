extends ../libs/jade/layout-clean

block title
  | 定制你的花样音乐告白

block css
  meta(name="author",content="m.giccoo.com")
  //- meta(http-equiv="Content-Security-Policy",content="upgrade-insecure-requests")
  link(rel="stylesheet",href="//image.giccoo.com/projects/libs/css/animate.min.css")
  link(rel="stylesheet",href="css/yrdzst-Bold.css")
  //- link(rel="stylesheet",href="/libs/font/YRDZST-Heavy.css")
  //- link(rel="stylesheet",href="css/yrd-Medium.css")
  link(rel="stylesheet",href="css/base.css")
    
  script(async src="https://www.googletagmanager.com/gtag/js?id=UA-66865226-1")
  script.
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-66865226-1');
  //- script(src="//image.giccoo.com/projects/libs/js/min/vconsole.min.js")
  //- script.
    var vConsole = new VConsole();
    console.log('VConsole open');
  

block content
  // - url = "//image.giccoo.com/projects/YearOfThePig";
  - url = ".";
  //- .qrcode#qrcode
    .qr
      img(src="#{url}/img/qrcode.png")
      .text 请使用手机扫描二维码参与活动
  //- .public#public
    player(icon="true",loop="true",src="#{url}/mp3/bgm.mp3")
    //- .player(:class="{play: playing, pause: !playing}",@click="playing = !playing")
      .icon-play(:class="{play: playing, pause: !playing}")
    //- transition(name="page-fade")
      .note-text(v-show="note")
        p 建议打开手机声音<br/>获得更好体验效果
  #myDiv

  .load#load
    .content#loading(v-show="mounted",style="display: none")
      .bottle
        img(src="#{url}/img/bottle-empty.png")
        .water(:style="{bottom: (110-progress)*(-70)/100+'%'}")
          img(src="#{url}/img/bottle-water.png")
      .load-text
        p.centeralign.font Loading...{{progress}}%
  
  .main#main(:class="{biger: biger, smaller:smaller}",:style="{width: w+'px',height: h+'px'}")
    //- transition(name="page-fade")
      .play(:class="{on: canPlay}",@click="mute")
        .icon-play
          img(src="#{url}/img/icon-play.png")
        .icon-stop
          img(src="#{url}/img/icon-stop.png")
    transition(name="page-down")
      .note-message(v-show="noteShow",@click="noteShow = false",:class="{error: noteType}",style="display: none")
        .note-text {{noteText}}

    transition(name="page-fade")
      .loading-page(v-show="loading",style="display: none")
        .ball-spin-fade-loader
          div
          div
          div
          div
          div
          div
          div
          div
    transition(name="page-fade")
      .pop.pop-info(v-show="!agree",style="display: none")
        .content
          .info-box
            h1 康师傅茉莉音乐告白HTML5互动活动规则
            .article
              p 一、活动介绍：
              p 2019年4月25日0时-2019年12月31日24时，购买康师傅茉莉系列音乐告白活动产品，扫描瓶身二维码或通过康师傅茉莉官方微信（微信公众号：kangshifumoliqingcha）进入“定制你的花样音乐告白”HTML5互动活动（以下简称“本活动”）页面，根据提示，即可完成“定制你的专属花样音乐告白”，活动 仅限中国大陆地区。
              p 二、参与方式：
              p 1.您认真阅读并接受本活动规则所有条款后方能参加本活动；<br/>2.进入网易云音乐，按界面要求勾选《用户许可协议》和《隐私政策》。
              p 三、活动主办方：杭州顶津食品有限公司上海分公司
              p 四、 活动声明及注意事项：
              p 1.您保证，对于您参加本活动的告白文案，您是相关内容的全部权利的原始权利人或经过相关原始权利人的合法授权（此情况下，您确保授权给您的相关权利的权利人知悉并同意你按照本活动规则以及网易云音乐相关协议、规则，将告白文案的内容进行分享和传播。
              p 2.您保证： 您将文案内容上传至本活动的行为，即视为您已经确您拥有与告白文案内容相关的全部权利，按照本规则使用告白文案内容。
              p 3.您同意：将您上传的告白文案在全世界范围内免费授权给活动主办方，用于与本活动有关的一切线上或线下活动。
              p 4.您保证任何上传的文字不得包含反动、色情、暴力、赌博、酗酒等国家法律不允许传播的文字内容。如参与讨论的文字与主办方传递的积极形象或良好意愿不一致的信息或图像、主办方有权随时删除该等信息和图像；
              p 5.活动过程中，如因政府法律法规调整或行政命令要求或活动主办方的经营策略的调整，活动主办方有权根据上述调整或要求随时调整活动内容及规则。活动内容及规则调整时，活动主办方将另行向活动参与者公告通知相关的调整，活动内容及规则的调整和公告方式无需征得活动参与者的同意。主办方对本规则做出调整时，最新版本之规则将载于主办方活动网站（http://ksfml.masterkong.com.cn/music/index.html?source=product）。主办方有权根据法律法规、司法或行政命令的要求以及活动的实际情况，在法律允许的范围内随时取消、中止或终止本次活动； 
              p 6.本活动过程中关于包括但不限于不因网络传输原因而导致您提交的信息错误或延误，主办方不承担任何责任。
              p 7.本活动适用中华人民共和国大陆地区法律。因本活动引起的或与本活动有关的任何争议，由争议双方友好协商解决。如任何争议不能通过双方友好协商解决的，可通过其他有效法律途径最终解决。
              p 若对本活动有任何疑问，请至康师傅茉莉清茶官方微信（微信ID：kangshifumoliqingcha）进行留言。 活动主办方将在法律允许的范围内对本活动细则作出合理说明和解释。如遇不可抗力因素，活动主办方有权取消本活动。
            .btn(@click="goPage1")
              img(src="#{url}/img/btn-agree.png")

    transition(name="page-fade")
      .page.page-1(v-show="pageIndex == 1")
        .content
          #ugc

    transition(name="page-fade")
      .page.page-2(v-show="pageIndex == 2")
        .content

    transition(name="page-zoom")
      .pop.pop-note(v-show="registerShow",style="display: none")
        .content
          .textbox
            .edit(v-show="edit")
              .texts
                .text
                  textarea(v-model="text",v-reset-input,@focus="focusArea",@blur="blurArea")
                  p.music-name 
                    span ————
                    |《{{messagelist[messageIndex].name}}》
              .close(@click="edit = false")
                img(src="#{url}/img/icon-close.png")
            .messages(v-show="!edit",@click="editMessage",@touchstart="hideNote")
              transition(name="page-fade")
                //-(v-show="messageNote")
                .note
                  img(src="#{url}/img/note-1.png")
              .left(@click="moveLeft(0)")
                img(src="#{url}/img/arrow.png")
              .right(@click="moveRight(0)")
                img(src="#{url}/img/arrow.png")
              slider.texts(@number="numberChange")
                .text(v-for="item in messagelist")
                  p.messagecontent(v-html="toBr(item.text)")
                  p.music-name 
                    span ————
                    |《{{item.name}}》
                
              //- .texts
                .text-move
                  .text
                    p 咖啡加奶糖的声音，<br/>有恋爱的味道，<br/>你是咖啡，<br/>我就是奶糖！
                    p.music-name 
                      span ————
                      |《只对你有感觉》
                  .text
                    p 咖啡加奶糖的声音，<br/>有恋爱的味道，<br/>你是咖啡，<br/>我就是奶糖！
                    p.music-name 
                      span ————
                      |《只对你有感觉》
            .name
              span.font FROM:
              input(type="text",v-reset-input,v-model="nickname",placeholder="填写你的名字")
            .btn-gb(@click="goNext")
              img(src="#{url}/img/btn-gb.png")

    transition(name="page-fade")
      .pop.pop-question(v-show="lotteryShow",style="display: none")
        .content
          .question
            .note 密码提示：
            .box
              .left(@click="moveLeft(1)")
                  img(src="#{url}/img/arrow.png")
              .right(@click="moveRight(1)")
                img(src="#{url}/img/arrow.png")
              slider.texts(@number="numberChange2")
                .text(v-for="item in questionlist")
                  p {{item.q}}
            .note 输入答案：
            .group
              input(type="text",v-reset-input,v-model="question",:placeholder="'例如:'+questionlist[questionIndex].p")
            .btn-submit(@click="submit")
              img(src="#{url}/img/btn-submit.png")

    transition(name="page-fade")
      .pop.pop-question.pop-answer(v-show="questionPageShow",style="display: none")
        .content
          .question
            .note 密码提示：
            .box
              .texts
                .text
                  p {{getData.question}}
            .note 输入答案：
            .group
              input(type="text",v-reset-input,v-model="answer",placeholder="例如：2000年2月14日")
            .btn-submit(@click="checkAnswer")
              img(src="#{url}/img/btn-answer.png")
          
    .pop.flashcamera(v-show="ugcShow",style="display: none")
      .content
        .small-size
          .close(@click="closeUGC")
            img(src="#{url}/img/icon-close.png")
          .scroll
            img(:src="ugc")
          .note 长按保存图片
block js
  - url = "/";
  script(src="//res.wx.qq.com/open/js/jweixin-1.3.2.js")
  script(src="//image.giccoo.com/projects/libs/js/min/ntes.id.js")
  script(src="//image.giccoo.com/projects/libs/js/min/music-jssdk-1.4.1.js")
  script(src="//image.giccoo.com/projects/libs/js/min/qrcode.min.js")
  script(src="//cdnjs.cloudflare.com/ajax/libs/vue/2.5.22/vue.min.js")
  script(src="//cdnjs.cloudflare.com/ajax/libs/PreloadJS/1.0.1/preloadjs.min.js")
  script(src="//cdnjs.cloudflare.com/ajax/libs/pixi.js/4.8.7/pixi.min.js")
  script(src="js/main.js?v=1")



  



  
