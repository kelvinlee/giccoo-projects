"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}THREE.GLTFLoader=function(){function e(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager,this.dracoLoader=null}function n(){var n={};return{get:function e(t){return n[t]},add:function e(t,r){n[t]=r},remove:function e(t){delete n[t]},removeAll:function e(){n={}}}}function m(){if(!THREE.DDSLoader)throw new Error("THREE.GLTFLoader: Attempting to load .dds texture without importing THREE.DDSLoader");this.name=_.MSFT_TEXTURE_DDS,this.ddsLoader=new THREE.DDSLoader}function d(e){this.name=_.KHR_LIGHTS_PUNCTUAL;var t=e.extensions&&e.extensions[_.KHR_LIGHTS_PUNCTUAL]||{};this.lightDefs=t.lights||[]}function E(e){this.name=_.KHR_MATERIALS_UNLIT}function f(e){this.name=_.KHR_BINARY_GLTF,this.content=null,this.body=null;var t=new DataView(e,0,p);if(this.header={magic:THREE.LoaderUtils.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==O)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected. Use LegacyGLTFLoader instead.");for(var r=new DataView(e,p),n=0;n<r.byteLength;){var a=r.getUint32(n,!0);n+=4;var o=r.getUint32(n,!0);if(n+=4,o===N.JSON){var i=new Uint8Array(e,p+n,a);this.content=THREE.LoaderUtils.decodeText(i)}else if(o===N.BIN){var s=p+n;this.body=e.slice(s,s+a)}n+=a}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}function v(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=_.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,THREE.DRACOLoader.getDecoderModule()}function g(e){this.name=_.KHR_TEXTURE_TRANSFORM}function T(){return{name:_.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function e(){return THREE.ShaderMaterial},extendParams:function e(t,r,n){var a=r.extensions[this.name],o=THREE.ShaderLib.standard,i=THREE.UniformsUtils.clone(o.uniforms),s=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),l=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),c=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),u=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),p=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb;","material.specularRoughness = clamp( 1.0 - glossinessFactor, 0.04, 1.0 );","material.specularColor = specularFactor.rgb;"].join("\n"),h=o.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",s).replace("#include <metalnessmap_pars_fragment>",l).replace("#include <roughnessmap_fragment>",c).replace("#include <metalnessmap_fragment>",u).replace("#include <lights_physical_fragment>",p);delete i.roughness,delete i.metalness,delete i.roughnessMap,delete i.metalnessMap,i.specular={value:(new THREE.Color).setHex(1118481)},i.glossiness={value:.5},i.specularMap={value:null},i.glossinessMap={value:null},t.vertexShader=o.vertexShader,t.fragmentShader=h,t.uniforms=i,t.defines={STANDARD:""},t.color=new THREE.Color(1,1,1),t.opacity=1;var m=[];if(Array.isArray(a.diffuseFactor)){var d=a.diffuseFactor;t.color.fromArray(d),t.opacity=d[3]}if(void 0!==a.diffuseTexture&&m.push(n.assignTexture(t,"map",a.diffuseTexture)),t.emissive=new THREE.Color(0,0,0),t.glossiness=void 0!==a.glossinessFactor?a.glossinessFactor:1,t.specular=new THREE.Color(1,1,1),Array.isArray(a.specularFactor)&&t.specular.fromArray(a.specularFactor),void 0!==a.specularGlossinessTexture){var E=a.specularGlossinessTexture;m.push(n.assignTexture(t,"glossinessMap",E)),m.push(n.assignTexture(t,"specularMap",E))}return Promise.all(m)},createMaterial:function e(t){var r=new THREE.ShaderMaterial({defines:t.defines,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader,uniforms:t.uniforms,fog:!0,lights:!0,opacity:t.opacity,transparent:t.transparent});return r.isGLTFSpecularGlossinessMaterial=!0,r.color=t.color,r.map=void 0===t.map?null:t.map,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=void 0===t.aoMap?null:t.aoMap,r.aoMapIntensity=1,r.emissive=t.emissive,r.emissiveIntensity=1,r.emissiveMap=void 0===t.emissiveMap?null:t.emissiveMap,r.bumpMap=void 0===t.bumpMap?null:t.bumpMap,r.bumpScale=1,r.normalMap=void 0===t.normalMap?null:t.normalMap,t.normalScale&&(r.normalScale=t.normalScale),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.specularMap=void 0===t.specularMap?null:t.specularMap,r.specular=t.specular,r.glossinessMap=void 0===t.glossinessMap?null:t.glossinessMap,r.glossiness=t.glossiness,r.alphaMap=null,r.envMap=void 0===t.envMap?null:t.envMap,r.envMapIntensity=1,r.refractionRatio=.98,r.extensions.derivatives=!0,r},cloneMaterial:function e(t){var r=t.clone();r.isGLTFSpecularGlossinessMaterial=!0;for(var n=this.specularGlossinessParams,a=0,o=n.length;a<o;a++)r[n[a]]=t[n[a]];return r},refreshUniforms:function e(t,r,n,a,o,i){if(!0===o.isGLTFSpecularGlossinessMaterial){var s=o.uniforms,l=o.defines,c;s.opacity.value=o.opacity,s.diffuse.value.copy(o.color),s.emissive.value.copy(o.emissive).multiplyScalar(o.emissiveIntensity),s.map.value=o.map,s.specularMap.value=o.specularMap,s.alphaMap.value=o.alphaMap,s.lightMap.value=o.lightMap,s.lightMapIntensity.value=o.lightMapIntensity,s.aoMap.value=o.aoMap,s.aoMapIntensity.value=o.aoMapIntensity,o.map?c=o.map:o.specularMap?c=o.specularMap:o.displacementMap?c=o.displacementMap:o.normalMap?c=o.normalMap:o.bumpMap?c=o.bumpMap:o.glossinessMap?c=o.glossinessMap:o.alphaMap?c=o.alphaMap:o.emissiveMap&&(c=o.emissiveMap),void 0!==c&&(c.isWebGLRenderTarget&&(c=c.texture),!0===c.matrixAutoUpdate&&c.updateMatrix(),s.uvTransform.value.copy(c.matrix)),o.envMap&&(s.envMap.value=o.envMap,s.envMapIntensity.value=o.envMapIntensity,s.flipEnvMap.value=o.envMap.isCubeTexture?-1:1,s.reflectivity.value=o.reflectivity,s.refractionRatio.value=o.refractionRatio,s.maxMipLevel.value=t.properties.get(o.envMap).__maxMipLevel),s.specular.value.copy(o.specular),s.glossiness.value=o.glossiness,s.glossinessMap.value=o.glossinessMap,s.emissiveMap.value=o.emissiveMap,s.bumpMap.value=o.bumpMap,s.normalMap.value=o.normalMap,s.displacementMap.value=o.displacementMap,s.displacementScale.value=o.displacementScale,s.displacementBias.value=o.displacementBias,null!==s.glossinessMap.value&&void 0===l.USE_GLOSSINESSMAP&&(l.USE_GLOSSINESSMAP="",l.USE_ROUGHNESSMAP=""),null===s.glossinessMap.value&&void 0!==l.USE_GLOSSINESSMAP&&(delete l.USE_GLOSSINESSMAP,delete l.USE_ROUGHNESSMAP)}}}}function M(e,t,r,n){THREE.Interpolant.call(this,e,t,r,n)}function h(e,t){return"string"!=typeof e||""===e?"":/^(https?:)?\/\//i.test(e)?e:/^data:.*,.*$/i.test(e)?e:/^blob:.*$/i.test(e)?e:t+e}function o(){return new THREE.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:THREE.FrontSide})}function R(e,t,r){for(var n in r.extensions)void 0===e[n]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[n]=r.extensions[n])}function A(e,t){void 0!==t.extras&&("object"===_typeof(t.extras)?e.userData=t.extras:console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function c(m,d,e){for(var E=!1,f=!1,t=0,r=d.length;t<r;t++){var n;if(void 0!==(n=d[t]).POSITION&&(E=!0),void 0!==n.NORMAL&&(f=!0),E&&f)break}if(!E&&!f)return Promise.resolve(m);for(var a=[],o=[],t=0,r=d.length;t<r;t++){var n=d[t];if(E){var i=void 0!==n.POSITION?e.getDependency("accessor",n.POSITION).then(function(e){return l(e)}):m.attributes.position;a.push(i)}if(f){var i=void 0!==n.NORMAL?e.getDependency("accessor",n.NORMAL).then(function(e){return l(e)}):m.attributes.normal;o.push(i)}}return Promise.all([Promise.all(a),Promise.all(o)]).then(function(e){for(var t=e[0],r=e[1],n=0,a=d.length;n<a;n++){var o=d[n],i="morphTarget"+n;if(E&&void 0!==o.POSITION){var s=t[n];s.name=i;for(var l=m.attributes.position,c=0,u=s.count;c<u;c++)s.setXYZ(c,s.getX(c)+l.getX(c),s.getY(c)+l.getY(c),s.getZ(c)+l.getZ(c))}if(f&&void 0!==o.NORMAL){var p=r[n];p.name=i;for(var h=m.attributes.normal,c=0,u=p.count;c<u;c++)p.setXYZ(c,p.getX(c)+h.getX(c),p.getY(c)+h.getY(c),p.getZ(c)+h.getZ(c))}}return E&&(m.morphAttributes.position=t),f&&(m.morphAttributes.normal=r),m})}function x(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(var r=0,n=t.weights.length;r<n;r++)e.morphTargetInfluences[r]=t.weights[r];if(t.extras&&Array.isArray(t.extras.targetNames)){var a=t.extras.targetNames;if(e.morphTargetInfluences.length===a.length){e.morphTargetDictionary={};for(var r=0,n=a.length;r<n;r++)e.morphTargetDictionary[a[r]]=r}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function i(e,t){var r=e.extensions?e.extensions[_.KHR_DRACO_MESH_COMPRESSION]:void 0,n=t.extensions?t.extensions[_.KHR_DRACO_MESH_COMPRESSION]:void 0;return r&&n?r.bufferView===n.bufferView&&u(r.attributes,n.attributes):e.indices===t.indices&&u(e.attributes,t.attributes)}function u(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var r in e)if(e[r]!==t[r])return!1;return!0}function s(e,t){if(e.length!==t.length)return!1;for(var r=0,n=e.length;r<n;r++)if(e[r]!==t[r])return!1;return!0}function y(e,t){for(var r=0,n=e.length;r<n;r++){var a=e[r];if(i(a.primitive,t))return a.promise}return null}function b(e,t){for(var r=0,n=e.length;r<n;r++){var a=e[r];if(s(t,a.baseGeometries))return a.geometry}return null}function H(e,t,r){for(var n=0,a=e.length;n<a;n++){var o=e[n];if(t===o.baseGeometry&&s(r,o.primitives))return o.geometry}return null}function l(e){if(e.isInterleavedBufferAttribute){for(var t=e.count,r=e.itemSize,n=e.array.slice(0,t*r),a=0,o=0;a<t;++a)n[o++]=e.getX(a),2<=r&&(n[o++]=e.getY(a)),3<=r&&(n[o++]=e.getZ(a)),4<=r&&(n[o++]=e.getW(a));return new THREE.BufferAttribute(n,r,e.normalized)}return e.clone()}function S(e){if(e.length<2)return!1;var t=e[0],r=t.targets||[];if(void 0===t.indices)return!1;for(var n=1,a=e.length;n<a;n++){var o=e[n];if(t.mode!==o.mode)return!1;if(void 0===o.indices)return!1;if(o.extensions&&o.extensions[_.KHR_DRACO_MESH_COMPRESSION])return!1;if(!u(t.attributes,o.attributes))return!1;var i=o.targets||[];if(r.length!==i.length)return!1;for(var s=0,l=r.length;s<l;s++)if(!u(r[s],i[s]))return!1}return!0}function L(e,t,r){this.json=e||{},this.extensions=t||{},this.options=r||{},this.cache=new n,this.primitiveCache=[],this.multiplePrimitivesCache=[],this.multiPassGeometryCache=[],this.textureLoader=new THREE.TextureLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new THREE.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer")}function w(r,e,n){function t(e,t){return n.getDependency("accessor",e).then(function(e){r.addAttribute(t,e)})}var a=e.attributes,o=[];for(var i in a){var s=ae[i];s&&(s in r.attributes||o.push(t(a[i],s)))}if(void 0!==e.indices&&!r.index){var l=n.getDependency("accessor",e.indices).then(function(e){r.setIndex(e)});o.push(l)}return A(r,e),Promise.all(o).then(function(){return void 0!==e.targets?c(r,e.targets,n):r})}e.prototype={constructor:e,crossOrigin:"anonymous",load:function e(r,t,n,a){var o=this,i;i=void 0!==this.resourcePath?this.resourcePath:void 0!==this.path?this.path:THREE.LoaderUtils.extractUrlBase(r),o.manager.itemStart(r);var s=function e(t){a?a(t):console.error(t),o.manager.itemError(r),o.manager.itemEnd(r)},l=new THREE.FileLoader(o.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.load(r,function(e){try{o.parse(e,i,function(e){t(e),o.manager.itemEnd(r)},s)}catch(e){s(e)}},n,s)},setCrossOrigin:function e(t){return this.crossOrigin=t,this},setPath:function e(t){return this.path=t,this},setResourcePath:function e(t){return this.resourcePath=t,this},setDRACOLoader:function e(t){return this.dracoLoader=t,this},parse:function e(t,r,i,n){var a,s={},o;if("string"==typeof t)a=t;else if(THREE.LoaderUtils.decodeText(new Uint8Array(t,0,4))===O){try{s[_.KHR_BINARY_GLTF]=new f(t)}catch(e){return void(n&&n(e))}a=s[_.KHR_BINARY_GLTF].content}else a=THREE.LoaderUtils.decodeText(new Uint8Array(t));var l=JSON.parse(a);if(void 0===l.asset||l.asset.version[0]<2)n&&n(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported. Use LegacyGLTFLoader instead."));else{if(l.extensionsUsed)for(var c=0;c<l.extensionsUsed.length;++c){var u=l.extensionsUsed[c],p=l.extensionsRequired||[];switch(u){case _.KHR_LIGHTS_PUNCTUAL:s[u]=new d(l);break;case _.KHR_MATERIALS_UNLIT:s[u]=new E(l);break;case _.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:s[u]=new T(l);break;case _.KHR_DRACO_MESH_COMPRESSION:s[u]=new v(l,this.dracoLoader);break;case _.MSFT_TEXTURE_DDS:s[_.MSFT_TEXTURE_DDS]=new m(l);break;case _.KHR_TEXTURE_TRANSFORM:s[_.KHR_TEXTURE_TRANSFORM]=new g(l);break;default:0<=p.indexOf(u)&&console.warn('THREE.GLTFLoader: Unknown extension "'+u+'".')}}var h=new L(l,s,{path:r||this.resourcePath||"",crossOrigin:this.crossOrigin,manager:this.manager});h.parse(function(e,t,r,n,a){var o={scene:e,scenes:t,cameras:r,animations:n,asset:a.asset,parser:h,userData:{}};R(s,o,a),i(o)},n)}}};var _={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",MSFT_TEXTURE_DDS:"MSFT_texture_dds"};d.prototype.loadLight=function(e){var t=this.lightDefs[e],r,n=new THREE.Color(16777215);void 0!==t.color&&n.fromArray(t.color);var a=void 0!==t.range?t.range:0;switch(t.type){case"directional":(r=new THREE.DirectionalLight(n)).target.position.set(0,0,-1),r.add(r.target);break;case"point":(r=new THREE.PointLight(n)).distance=a;break;case"spot":(r=new THREE.SpotLight(n)).distance=a,t.spot=t.spot||{},t.spot.innerConeAngle=void 0!==t.spot.innerConeAngle?t.spot.innerConeAngle:0,t.spot.outerConeAngle=void 0!==t.spot.outerConeAngle?t.spot.outerConeAngle:Math.PI/4,r.angle=t.spot.outerConeAngle,r.penumbra=1-t.spot.innerConeAngle/t.spot.outerConeAngle,r.target.position.set(0,0,-1),r.add(r.target);break;default:throw new Error('THREE.GLTFLoader: Unexpected light type, "'+t.type+'".')}return r.decay=2,void 0!==t.intensity&&(r.intensity=t.intensity),r.name=t.name||"light_"+e,Promise.resolve(r)},E.prototype.getMaterialType=function(e){return THREE.MeshBasicMaterial},E.prototype.extendParams=function(e,t,r){var n=[];e.color=new THREE.Color(1,1,1),e.opacity=1;var a=t.pbrMetallicRoughness;if(a){if(Array.isArray(a.baseColorFactor)){var o=a.baseColorFactor;e.color.fromArray(o),e.opacity=o[3]}void 0!==a.baseColorTexture&&n.push(r.assignTexture(e,"map",a.baseColorTexture))}return Promise.all(n)};var t="binary_glTF",O="glTF",p=12,N={JSON:1313821514,BIN:5130562};v.prototype.decodePrimitive=function(e,t){var r=this.json,n=this.dracoLoader,a=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,i={},s={},l={};for(var c in o)c in ae&&(i[ae[c]]=o[c]);for(c in e.attributes)if(void 0!==ae[c]&&void 0!==o[c]){var u=r.accessors[e.attributes[c]],p=W[u.componentType];l[ae[c]]=p,s[ae[c]]=!0===u.normalized}return t.getDependency("bufferView",a).then(function(e){return new Promise(function(a){n.decodeDracoFile(e,function(e){for(var t in e.attributes){var r=e.attributes[t],n=s[t];void 0!==n&&(r.normalized=n)}a(e)},i,l)})})},g.prototype.extendTexture=function(e,t){return e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),e.needsUpdate=!0,e},M.prototype=Object.create(THREE.Interpolant.prototype),(M.prototype.constructor=M).prototype.copySampleValue_=function(e){for(var t=this.resultBuffer,r=this.sampleValues,n=this.valueSize,a=e*n*3+n,o=0;o!==n;o++)t[o]=r[a+o];return t},M.prototype.beforeStart_=M.prototype.copySampleValue_,M.prototype.afterEnd_=M.prototype.copySampleValue_,M.prototype.interpolate_=function(e,t,r,n){for(var a=this.resultBuffer,o=this.sampleValues,i=this.valueSize,s=2*i,l=3*i,c=n-t,u=(r-t)/c,p=u*u,h=p*u,m=e*l,d=m-l,E=-2*h+3*p,f=h-p,v=1-E,g=f-p+u,T=0;T!==i;T++){var R=o[d+T+i],y=o[d+T+s]*c,b=o[m+T+i],H=o[m+T]*c;a[T]=v*R+g*y+E*b+f*H}return a};var r=5126,a=35675,P=35676,C=35664,I=35665,F=35666,D=9729,U=10497,G=35678,j=0,V=1,k=2,B=3,K=4,z=5,X=6,Y=5121,Z=5123,q={5126:Number,35675:THREE.Matrix3,35676:THREE.Matrix4,35664:THREE.Vector2,35665:THREE.Vector3,35666:THREE.Vector4,35678:THREE.Texture},W={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},J={9728:THREE.NearestFilter,9729:THREE.LinearFilter,9984:THREE.NearestMipMapNearestFilter,9985:THREE.LinearMipMapNearestFilter,9986:THREE.NearestMipMapLinearFilter,9987:THREE.LinearMipMapLinearFilter},Q={33071:THREE.ClampToEdgeWrapping,33648:THREE.MirroredRepeatWrapping,10497:THREE.RepeatWrapping},$={1028:THREE.BackSide,1029:THREE.FrontSide},ee={512:THREE.NeverDepth,513:THREE.LessDepth,514:THREE.EqualDepth,515:THREE.LessEqualDepth,516:THREE.GreaterEqualDepth,517:THREE.NotEqualDepth,518:THREE.GreaterEqualDepth,519:THREE.AlwaysDepth},te={32774:THREE.AddEquation,32778:THREE.SubtractEquation,32779:THREE.ReverseSubtractEquation},re={0:THREE.ZeroFactor,1:THREE.OneFactor,768:THREE.SrcColorFactor,769:THREE.OneMinusSrcColorFactor,770:THREE.SrcAlphaFactor,771:THREE.OneMinusSrcAlphaFactor,772:THREE.DstAlphaFactor,773:THREE.OneMinusDstAlphaFactor,774:THREE.DstColorFactor,775:THREE.OneMinusDstColorFactor,776:THREE.SrcAlphaSaturateFactor},ne={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},ae={POSITION:"position",NORMAL:"normal",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},oe={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},ie={CUBICSPLINE:THREE.InterpolateSmooth,LINEAR:THREE.InterpolateLinear,STEP:THREE.InterpolateDiscrete},se={2884:"CULL_FACE",2929:"DEPTH_TEST",3042:"BLEND",3089:"SCISSOR_TEST",32823:"POLYGON_OFFSET_FILL",32926:"SAMPLE_ALPHA_TO_COVERAGE"},le="OPAQUE",ce="MASK",ue="BLEND",pe={"image/png":THREE.RGBAFormat,"image/jpeg":THREE.RGBFormat};return L.prototype.parse=function(o,e){var i=this.json;this.cache.removeAll(),this.markDefs(),this.getMultiDependencies(["scene","animation","camera"]).then(function(e){var t=e.scenes||[],r=t[i.scene||0],n=e.animations||[],a=e.cameras||[];o(r,t,a,n,i)}).catch(e)},L.prototype.markDefs=function(){for(var e=this.json.nodes||[],t=this.json.skins||[],r=this.json.meshes||[],n={},a={},o=0,i=t.length;o<i;o++)for(var s=t[o].joints,l=0,c=s.length;l<c;l++)e[s[l]].isBone=!0;for(var u=0,p=e.length;u<p;u++){var h=e[u];void 0!==h.mesh&&(void 0===n[h.mesh]&&(n[h.mesh]=a[h.mesh]=0),n[h.mesh]++,void 0!==h.skin&&(r[h.mesh].isSkinnedMesh=!0))}this.json.meshReferences=n,this.json.meshUses=a},L.prototype.getDependency=function(e,t){var r=e+":"+t,n=this.cache.get(r);if(!n){switch(e){case"scene":n=this.loadScene(t);break;case"node":n=this.loadNode(t);break;case"mesh":n=this.loadMesh(t);break;case"accessor":n=this.loadAccessor(t);break;case"bufferView":n=this.loadBufferView(t);break;case"buffer":n=this.loadBuffer(t);break;case"material":n=this.loadMaterial(t);break;case"texture":n=this.loadTexture(t);break;case"skin":n=this.loadSkin(t);break;case"animation":n=this.loadAnimation(t);break;case"camera":n=this.loadCamera(t);break;case"light":n=this.extensions[_.KHR_LIGHTS_PUNCTUAL].loadLight(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(r,n)}return n},L.prototype.getDependencies=function(r){var e=this.cache.get(r);if(!e){var n=this,t=this.json[r+("mesh"===r?"es":"s")]||[];e=Promise.all(t.map(function(e,t){return n.getDependency(r,t)})),this.cache.add(r,e)}return e},L.prototype.getMultiDependencies=function(e){for(var r={},t=[],n=0,a=e.length;n<a;n++){var o=e[n],i=this.getDependencies(o);i=i.then(function(e,t){r[e]=t}.bind(this,o+("mesh"===o?"es":"s"))),t.push(i)}return Promise.all(t).then(function(){return r})},L.prototype.loadBuffer=function(e){var r=this.json.buffers[e],n=this.fileLoader;if(r.type&&"arraybuffer"!==r.type)throw new Error("THREE.GLTFLoader: "+r.type+" buffer type is not supported.");if(void 0===r.uri&&0===e)return Promise.resolve(this.extensions[_.KHR_BINARY_GLTF].body);var a=this.options;return new Promise(function(e,t){n.load(h(r.uri,a.path),e,void 0,function(){t(new Error('THREE.GLTFLoader: Failed to load buffer "'+r.uri+'".'))})})},L.prototype.loadBufferView=function(e){var n=this.json.bufferViews[e];return this.getDependency("buffer",n.buffer).then(function(e){var t=n.byteLength||0,r=n.byteOffset||0;return e.slice(r,r+t)})},L.prototype.loadAccessor=function(e){var b=this,H=this.json,M=this.json.accessors[e];if(void 0===M.bufferView&&void 0===M.sparse)return Promise.resolve(null);var t=[];return void 0!==M.bufferView?t.push(this.getDependency("bufferView",M.bufferView)):t.push(null),void 0!==M.sparse&&(t.push(this.getDependency("bufferView",M.sparse.indices.bufferView)),t.push(this.getDependency("bufferView",M.sparse.values.bufferView))),Promise.all(t).then(function(e){var t=e[0],r=ne[M.type],n=W[M.componentType],a=n.BYTES_PER_ELEMENT,o=a*r,i=M.byteOffset||0,s=void 0!==M.bufferView?H.bufferViews[M.bufferView].byteStride:void 0,l=!0===M.normalized,c,u;if(s&&s!==o){var p="InterleavedBuffer:"+M.bufferView+":"+M.componentType,h=b.cache.get(p);h||(c=new n(t),h=new THREE.InterleavedBuffer(c,s/a),b.cache.add(p,h)),u=new THREE.InterleavedBufferAttribute(h,r,i/a,l)}else c=null===t?new n(M.count*r):new n(t,i,M.count*r),u=new THREE.BufferAttribute(c,r,l);if(void 0!==M.sparse){var m=ne.SCALAR,d=W[M.sparse.indices.componentType],E=M.sparse.indices.byteOffset||0,f=M.sparse.values.byteOffset||0,v=new d(e[1],E,M.sparse.count*m),g=new n(e[2],f,M.sparse.count*r);null!==t&&u.setArray(u.array.slice());for(var T=0,R=v.length;T<R;T++){var y=v[T];if(u.setX(y,g[T*r]),2<=r&&u.setY(y,g[T*r+1]),3<=r&&u.setZ(y,g[T*r+2]),4<=r&&u.setW(y,g[T*r+3]),5<=r)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return u})},L.prototype.loadTexture=function(e){var t=this,n=this.json,a=this.options,o=this.textureLoader,i=window.URL||window.webkitURL,s=n.textures[e],l=s.extensions||{},c,u=(c=l[_.MSFT_TEXTURE_DDS]?n.images[l[_.MSFT_TEXTURE_DDS].source]:n.images[s.source]).uri,p=!1;return void 0!==c.bufferView&&(u=t.getDependency("bufferView",c.bufferView).then(function(e){p=!0;var t=new Blob([e],{type:c.mimeType});return u=i.createObjectURL(t)})),Promise.resolve(u).then(function(r){var n=THREE.Loader.Handlers.get(r);return n||(n=l[_.MSFT_TEXTURE_DDS]?t.extensions[_.MSFT_TEXTURE_DDS].ddsLoader:o),new Promise(function(e,t){n.load(h(r,a.path),e,void 0,t)})}).then(function(e){!0===p&&i.revokeObjectURL(u),e.flipY=!1,void 0!==s.name&&(e.name=s.name),c.mimeType in pe&&(e.format=pe[c.mimeType]);var t,r=(n.samplers||{})[s.sampler]||{};return e.magFilter=J[r.magFilter]||THREE.LinearFilter,e.minFilter=J[r.minFilter]||THREE.LinearMipMapLinearFilter,e.wrapS=Q[r.wrapS]||THREE.RepeatWrapping,e.wrapT=Q[r.wrapT]||THREE.RepeatWrapping,e})},L.prototype.assignTexture=function(r,n,a){var o=this;return this.getDependency("texture",a.index).then(function(e){if(o.extensions[_.KHR_TEXTURE_TRANSFORM]){var t=void 0!==a.extensions?a.extensions[_.KHR_TEXTURE_TRANSFORM]:void 0;t&&(e=o.extensions[_.KHR_TEXTURE_TRANSFORM].extendTexture(e,t))}r[n]=e})},L.prototype.loadMaterial=function(e){var t=this,r=this.json,n=this.extensions,a=r.materials[e],o,i={},s=a.extensions||{},l=[];if(s[_.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var c=n[_.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];o=c.getMaterialType(a),l.push(c.extendParams(i,a,t))}else if(s[_.KHR_MATERIALS_UNLIT]){var u=n[_.KHR_MATERIALS_UNLIT];o=u.getMaterialType(a),l.push(u.extendParams(i,a,t))}else{o=THREE.MeshStandardMaterial;var p=a.pbrMetallicRoughness||{};if(i.color=new THREE.Color(1,1,1),i.opacity=1,Array.isArray(p.baseColorFactor)){var h=p.baseColorFactor;i.color.fromArray(h),i.opacity=h[3]}void 0!==p.baseColorTexture&&l.push(t.assignTexture(i,"map",p.baseColorTexture)),i.metalness=void 0!==p.metallicFactor?p.metallicFactor:1,i.roughness=void 0!==p.roughnessFactor?p.roughnessFactor:1,void 0!==p.metallicRoughnessTexture&&(l.push(t.assignTexture(i,"metalnessMap",p.metallicRoughnessTexture)),l.push(t.assignTexture(i,"roughnessMap",p.metallicRoughnessTexture)))}!0===a.doubleSided&&(i.side=THREE.DoubleSide);var m=a.alphaMode||le;return m===ue?i.transparent=!0:(i.transparent=!1,m===ce&&(i.alphaTest=void 0!==a.alphaCutoff?a.alphaCutoff:.5)),void 0!==a.normalTexture&&o!==THREE.MeshBasicMaterial&&(l.push(t.assignTexture(i,"normalMap",a.normalTexture)),i.normalScale=new THREE.Vector2(1,1),void 0!==a.normalTexture.scale&&i.normalScale.set(a.normalTexture.scale,a.normalTexture.scale)),void 0!==a.occlusionTexture&&o!==THREE.MeshBasicMaterial&&(l.push(t.assignTexture(i,"aoMap",a.occlusionTexture)),void 0!==a.occlusionTexture.strength&&(i.aoMapIntensity=a.occlusionTexture.strength)),void 0!==a.emissiveFactor&&o!==THREE.MeshBasicMaterial&&(i.emissive=(new THREE.Color).fromArray(a.emissiveFactor)),void 0!==a.emissiveTexture&&o!==THREE.MeshBasicMaterial&&l.push(t.assignTexture(i,"emissiveMap",a.emissiveTexture)),Promise.all(l).then(function(){var e;return e=o===THREE.ShaderMaterial?n[_.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(i):new o(i),void 0!==a.name&&(e.name=a.name),e.normalScale&&(e.normalScale.y=-e.normalScale.y),e.map&&(e.map.encoding=THREE.sRGBEncoding),e.emissiveMap&&(e.emissiveMap.encoding=THREE.sRGBEncoding),e.specularMap&&(e.specularMap.encoding=THREE.sRGBEncoding),A(e,a),a.extensions&&R(n,e,a),e})},L.prototype.loadGeometries=function(i){function e(t){return r[_.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(t,s).then(function(e){return w(e,t,s)})}var s=this,r=this.extensions,t=this.primitiveCache,p=S(i),h;p&&(i=[(h=i)[0]]);for(var n=[],a=0,o=i.length;a<o;a++){var l=i[a],c=y(t,l),u;if(c)n.push(c);else u=l.extensions&&l.extensions[_.KHR_DRACO_MESH_COMPRESSION]?e(l):w(new THREE.BufferGeometry,l,s),t.push({primitive:l,promise:u}),n.push(u)}return Promise.all(n).then(function(e){if(p){var l=e[0],c,t;if(null!==(t=H(c=s.multiPassGeometryCache,l,h)))return[t.geometry];var u=new THREE.BufferGeometry;for(var r in u.name=l.name,u.userData=l.userData,l.attributes)u.addAttribute(r,l.attributes[r]);for(var r in l.morphAttributes)u.morphAttributes[r]=l.morphAttributes[r];for(var n=[],a=0,o=h.length;a<o;a++)n.push(s.getDependency("accessor",h[a].indices));return Promise.all(n).then(function(e){for(var t=[],r=0,n=0,a=h.length;n<a;n++){for(var o=e[n],i=0,s=o.count;i<s;i++)t.push(o.array[i]);u.addGroup(r,o.count,n),r+=o.count}return u.setIndex(t),c.push({geometry:u,baseGeometry:l,primitives:h}),[u]})}if(1<e.length&&void 0!==THREE.BufferGeometryUtils){for(var a=1,o=i.length;a<o;a++)if(i[0].mode!==i[a].mode)return e;var c,t;if(t=b(c=s.multiplePrimitivesCache,e)){if(null!==t.geometry)return[t.geometry]}else{var u=THREE.BufferGeometryUtils.mergeBufferGeometries(e,!0);if(c.push({geometry:u,baseGeometries:e}),null!==u)return[u]}}return e})},L.prototype.loadMesh=function(H){for(var M=this,e=this.json,S=this.extensions,L=e.meshes[H],w=L.primitives,t=[],r=0,n=w.length;r<n;r++){var a=void 0===w[r].material?o():this.getDependency("material",w[r].material);t.push(a)}return Promise.all(t).then(function(b){return M.loadGeometries(w).then(function(e){for(var t=1===e.length&&0<e[0].groups.length,r=[],n=0,a=e.length;n<a;n++){var o=e[n],i=w[n],s,l=t?b:b[n];if(i.mode===K||i.mode===z||i.mode===X||void 0===i.mode)!0===(s=!0===L.isSkinnedMesh?new THREE.SkinnedMesh(o,l):new THREE.Mesh(o,l)).isSkinnedMesh&&s.normalizeSkinWeights(),i.mode===z?s.drawMode=THREE.TriangleStripDrawMode:i.mode===X&&(s.drawMode=THREE.TriangleFanDrawMode);else if(i.mode===V)s=new THREE.LineSegments(o,l);else if(i.mode===B)s=new THREE.Line(o,l);else if(i.mode===k)s=new THREE.LineLoop(o,l);else{if(i.mode!==j)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+i.mode);s=new THREE.Points(o,l)}0<Object.keys(s.geometry.morphAttributes).length&&x(s,L),s.name=L.name||"mesh_"+H,1<e.length&&(s.name+="_"+n),A(s,L),r.push(s);for(var c=t?s.material:[s.material],u=void 0!==o.attributes.color,p=void 0===o.attributes.normal,h=!0===s.isSkinnedMesh,m=0<Object.keys(o.morphAttributes).length,d=m&&void 0!==o.morphAttributes.normal,E=0,f=c.length;E<f;E++){var l=c[E];if(s.isPoints){var v="PointsMaterial:"+l.uuid,g=M.cache.get(v);g||(g=new THREE.PointsMaterial,THREE.Material.prototype.copy.call(g,l),g.color.copy(l.color),g.map=l.map,g.lights=!1,M.cache.add(v,g)),l=g}else if(s.isLine){var v="LineBasicMaterial:"+l.uuid,T=M.cache.get(v);T||(T=new THREE.LineBasicMaterial,THREE.Material.prototype.copy.call(T,l),T.color.copy(l.color),T.lights=!1,M.cache.add(v,T)),l=T}if(u||p||h||m){var v="ClonedMaterial:"+l.uuid+":";l.isGLTFSpecularGlossinessMaterial&&(v+="specular-glossiness:"),h&&(v+="skinning:"),u&&(v+="vertex-colors:"),p&&(v+="flat-shading:"),m&&(v+="morph-targets:"),d&&(v+="morph-normals:");var R=M.cache.get(v);R||(R=l.isGLTFSpecularGlossinessMaterial?S[_.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].cloneMaterial(l):l.clone(),h&&(R.skinning=!0),u&&(R.vertexColors=THREE.VertexColors),p&&(R.flatShading=!0),m&&(R.morphTargets=!0),d&&(R.morphNormals=!0),M.cache.add(v,R)),l=R}(c[E]=l).aoMap&&void 0===o.attributes.uv2&&void 0!==o.attributes.uv&&(console.log("THREE.GLTFLoader: Duplicating UVs to support aoMap."),o.addAttribute("uv2",new THREE.BufferAttribute(o.attributes.uv.array,2))),l.isGLTFSpecularGlossinessMaterial&&(s.onBeforeRender=S[_.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].refreshUniforms)}s.material=t?c:c[0]}if(1===r.length)return r[0];for(var y=new THREE.Group,n=0,a=r.length;n<a;n++)y.add(r[n]);return y})})},L.prototype.loadCamera=function(e){var t,r=this.json.cameras[e],n=r[r.type];if(n)return"perspective"===r.type?t=new THREE.PerspectiveCamera(THREE.Math.radToDeg(n.yfov),n.aspectRatio||1,n.znear||1,n.zfar||2e6):"orthographic"===r.type&&(t=new THREE.OrthographicCamera(n.xmag/-2,n.xmag/2,n.ymag/2,n.ymag/-2,n.znear,n.zfar)),void 0!==r.name&&(t.name=r.name),A(t,r),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")},L.prototype.loadSkin=function(e){var t=this.json.skins[e],r={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(r):this.getDependency("accessor",t.inverseBindMatrices).then(function(e){return r.inverseBindMatrices=e,r})},L.prototype.loadAnimation=function(b){for(var e,H=this.json.animations[b],t=[],r=[],n=[],a=[],o=[],i=0,s=H.channels.length;i<s;i++){var l=H.channels[i],c=H.samplers[l.sampler],u=l.target,p=void 0!==u.node?u.node:u.id,h=void 0!==H.parameters?H.parameters[c.input]:c.input,m=void 0!==H.parameters?H.parameters[c.output]:c.output;t.push(this.getDependency("node",p)),r.push(this.getDependency(
"accessor",h)),n.push(this.getDependency("accessor",m)),a.push(c),o.push(u)}return Promise.all([Promise.all(t),Promise.all(r),Promise.all(n),Promise.all(a),Promise.all(o)]).then(function(e){for(var t=e[0],r=e[1],n=e[2],a=e[3],o=e[4],i=[],s=0,l=t.length;s<l;s++){var c=t[s],u=r[s],p=n[s],h=a[s],m=o[s];if(void 0!==c){var d;switch(c.updateMatrix(),c.matrixAutoUpdate=!0,oe[m.path]){case oe.weights:d=THREE.NumberKeyframeTrack;break;case oe.rotation:d=THREE.QuaternionKeyframeTrack;break;case oe.position:case oe.scale:default:d=THREE.VectorKeyframeTrack;break}var E=c.name?c.name:c.uuid,f=void 0!==h.interpolation?ie[h.interpolation]:THREE.InterpolateLinear,v=[];oe[m.path]===oe.weights?c.traverse(function(e){!0===e.isMesh&&e.morphTargetInfluences&&v.push(e.name?e.name:e.uuid)}):v.push(E);for(var g=0,T=v.length;g<T;g++){var R=new d(v[g]+"."+oe[m.path],THREE.AnimationUtils.arraySlice(u.array,0),THREE.AnimationUtils.arraySlice(p.array,0),f);"CUBICSPLINE"===h.interpolation&&(R.createInterpolant=function e(t){return new M(this.times,this.values,this.getValueSize()/3,t)},R.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),i.push(R)}}}var y=void 0!==H.name?H.name:"animation_"+b;return new THREE.AnimationClip(y,void 0,i)})},L.prototype.loadNode=function(e){var t=this.json,r=this.extensions,n=this,o=t.meshReferences,i=t.meshUses,s=t.nodes[e];return(!0===s.isBone?Promise.resolve(new THREE.Bone):void 0!==s.mesh?n.getDependency("mesh",s.mesh).then(function(e){var t;if(1<o[s.mesh]){var r=i[s.mesh]++;(t=e.clone()).name+="_instance_"+r,t.onBeforeRender=e.onBeforeRender;for(var n=0,a=t.children.length;n<a;n++)t.children[n].name+="_instance_"+r,t.children[n].onBeforeRender=e.children[n].onBeforeRender}else t=e;return void 0!==s.weights&&t.traverse(function(e){if(e.isMesh)for(var t=0,r=s.weights.length;t<r;t++)e.morphTargetInfluences[t]=s.weights[t]}),t}):void 0!==s.camera?n.getDependency("camera",s.camera):s.extensions&&s.extensions[_.KHR_LIGHTS_PUNCTUAL]&&void 0!==s.extensions[_.KHR_LIGHTS_PUNCTUAL].light?n.getDependency("light",s.extensions[_.KHR_LIGHTS_PUNCTUAL].light):Promise.resolve(new THREE.Object3D)).then(function(e){if(void 0!==s.name&&(e.name=THREE.PropertyBinding.sanitizeNodeName(s.name)),A(e,s),s.extensions&&R(r,e,s),void 0!==s.matrix){var t=new THREE.Matrix4;t.fromArray(s.matrix),e.applyMatrix(t)}else void 0!==s.translation&&e.position.fromArray(s.translation),void 0!==s.rotation&&e.quaternion.fromArray(s.rotation),void 0!==s.scale&&e.scale.fromArray(s.scale);return e})},L.prototype.loadScene=function(){function p(e,i,s,l){var c=s.nodes[e];return l.getDependency("node",e).then(function(p){return void 0===c.skin?p:l.getDependency("skin",c.skin).then(function(e){for(var t=[],r=0,n=(h=e).joints.length;r<n;r++)t.push(l.getDependency("node",h.joints[r]));return Promise.all(t)}).then(function(e){for(var t=!0===p.isGroup?p.children:[p],r=0,n=t.length;r<n;r++){for(var a=t[r],o=[],i=[],s=0,l=e.length;s<l;s++){var c=e[s];if(c){o.push(c);var u=new THREE.Matrix4;void 0!==h.inverseBindMatrices&&u.fromArray(h.inverseBindMatrices.array,16*s),i.push(u)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',h.joints[s])}a.bind(new THREE.Skeleton(o,i),a.matrixWorld)}return p});var h}).then(function(e){i.add(e);var t=[];if(c.children)for(var r=c.children,n=0,a=r.length;n<a;n++){var o=r[n];t.push(p(o,e,s,l))}return Promise.all(t)})}return function e(t){var r=this.json,n=this.extensions,a=this.json.scenes[t],o=this,i=new THREE.Scene;void 0!==a.name&&(i.name=a.name),A(i,a),a.extensions&&R(n,i,a);for(var s=a.nodes||[],l=[],c=0,u=s.length;c<u;c++)l.push(p(s[c],i,r,o));return Promise.all(l).then(function(){return i})}}(),e}(),THREE.OBJLoader=function(){function Y(){var e={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materialLibraries:[],startObject:function e(t,r){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=t,void(this.object.fromDeclaration=!1!==r);var n=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0),this.object={name:t||"",fromDeclaration:!1!==r,geometry:{vertices:[],normals:[],colors:[],uvs:[]},materials:[],smooth:!0,startMaterial:function e(t,r){var n=this._finalize(!1);n&&(n.inherited||n.groupCount<=0)&&this.materials.splice(n.index,1);var a={index:this.materials.length,name:t||"",mtllib:Array.isArray(r)&&0<r.length?r[r.length-1]:"",smooth:void 0!==n?n.smooth:this.smooth,groupStart:void 0!==n?n.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function e(t){var r={index:"number"==typeof t?t:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return r.clone=this.clone.bind(r),r}};return this.materials.push(a),a},currentMaterial:function e(){if(0<this.materials.length)return this.materials[this.materials.length-1]},_finalize:function e(t){var r=this.currentMaterial();if(r&&-1===r.groupEnd&&(r.groupEnd=this.geometry.vertices.length/3,r.groupCount=r.groupEnd-r.groupStart,r.inherited=!1),t&&1<this.materials.length)for(var n=this.materials.length-1;0<=n;n--)this.materials[n].groupCount<=0&&this.materials.splice(n,1);return t&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),r}},n&&n.name&&"function"==typeof n.clone){var a=n.clone(0);a.inherited=!0,this.object.materials.push(a)}this.objects.push(this.object)},finalize:function e(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function e(t,r){var n=parseInt(t,10);return 3*(0<=n?n-1:n+r/3)},parseNormalIndex:function e(t,r){var n=parseInt(t,10);return 3*(0<=n?n-1:n+r/3)},parseUVIndex:function e(t,r){var n=parseInt(t,10);return 2*(0<=n?n-1:n+r/2)},addVertex:function e(t,r,n){var a=this.vertices,o=this.object.geometry.vertices;o.push(a[t+0],a[t+1],a[t+2]),o.push(a[r+0],a[r+1],a[r+2]),o.push(a[n+0],a[n+1],a[n+2])},addVertexPoint:function e(t){var r=this.vertices,n;this.object.geometry.vertices.push(r[t+0],r[t+1],r[t+2])},addVertexLine:function e(t){var r=this.vertices,n;this.object.geometry.vertices.push(r[t+0],r[t+1],r[t+2])},addNormal:function e(t,r,n){var a=this.normals,o=this.object.geometry.normals;o.push(a[t+0],a[t+1],a[t+2]),o.push(a[r+0],a[r+1],a[r+2]),o.push(a[n+0],a[n+1],a[n+2])},addColor:function e(t,r,n){var a=this.colors,o=this.object.geometry.colors;o.push(a[t+0],a[t+1],a[t+2]),o.push(a[r+0],a[r+1],a[r+2]),o.push(a[n+0],a[n+1],a[n+2])},addUV:function e(t,r,n){var a=this.uvs,o=this.object.geometry.uvs;o.push(a[t+0],a[t+1]),o.push(a[r+0],a[r+1]),o.push(a[n+0],a[n+1])},addUVLine:function e(t){var r=this.uvs,n;this.object.geometry.uvs.push(r[t+0],r[t+1])},addFace:function e(t,r,n,a,o,i,s,l,c){var u=this.vertices.length,p=this.parseVertexIndex(t,u),h=this.parseVertexIndex(r,u),m=this.parseVertexIndex(n,u);if(this.addVertex(p,h,m),void 0!==a&&""!==a){var d=this.uvs.length;p=this.parseUVIndex(a,d),h=this.parseUVIndex(o,d),m=this.parseUVIndex(i,d),this.addUV(p,h,m)}if(void 0!==s&&""!==s){var E=this.normals.length;p=this.parseNormalIndex(s,E),h=s===l?p:this.parseNormalIndex(l,E),m=s===c?p:this.parseNormalIndex(c,E),this.addNormal(p,h,m)}0<this.colors.length&&this.addColor(p,h,m)},addPointGeometry:function e(t){this.object.geometry.type="Points";for(var r=this.vertices.length,n=0,a=t.length;n<a;n++)this.addVertexPoint(this.parseVertexIndex(t[n],r))},addLineGeometry:function e(t,r){this.object.geometry.type="Line";for(var n=this.vertices.length,a=this.uvs.length,o=0,i=t.length;o<i;o++)this.addVertexLine(this.parseVertexIndex(t[o],n));for(var s=0,i=r.length;s<i;s++)this.addUVLine(this.parseUVIndex(r[s],a))}};return e.startObject("",!1),e}function e(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager,this.materials=null}var Z=/^[og]\s*(.+)?/,q=/^mtllib /,W=/^usemtl /;return e.prototype={constructor:e,load:function e(t,r,n,a){var o=this,i=new THREE.FileLoader(o.manager);i.setPath(this.path),i.load(t,function(e){r(o.parse(e))},n,a)},setPath:function e(t){return this.path=t,this},setMaterials:function e(t){return this.materials=t,this},parse:function e(t){console.time("OBJLoader");var r=new Y;-1!==t.indexOf("\r\n")&&(t=t.replace(/\r\n/g,"\n")),-1!==t.indexOf("\\\n")&&(t=t.replace(/\\\n/g,""));for(var n=t.split("\n"),a="",o="",i=0,s=[],l="function"==typeof"".trimLeft,c=0,u=n.length;c<u;c++)if(a=n[c],0!==(i=(a=l?a.trimLeft():a.trim()).length)&&"#"!==(o=a.charAt(0)))if("v"===o){var p=a.split(/\s+/);switch(p[0]){case"v":r.vertices.push(parseFloat(p[1]),parseFloat(p[2]),parseFloat(p[3])),8===p.length&&r.colors.push(parseFloat(p[4]),parseFloat(p[5]),parseFloat(p[6]));break;case"vn":r.normals.push(parseFloat(p[1]),parseFloat(p[2]),parseFloat(p[3]));break;case"vt":r.uvs.push(parseFloat(p[1]),parseFloat(p[2]));break}}else if("f"===o){for(var h,m=(h=a.substr(1).trim()).split(/\s+/),d=[],E=0,f=m.length;E<f;E++){var v=m[E];if(0<v.length){var g=v.split("/");d.push(g)}}for(var T=d[0],E=1,f=d.length-1;E<f;E++){var R=d[E],y=d[E+1];r.addFace(T[0],R[0],y[0],T[1],R[1],y[1],T[2],R[2],y[2])}}else if("l"===o){var b=a.substring(1).trim().split(" "),H=[],M=[];if(-1===a.indexOf("/"))H=b;else for(var S=0,L=b.length;S<L;S++){var w=b[S].split("/");""!==w[0]&&H.push(w[0]),""!==w[1]&&M.push(w[1])}r.addLineGeometry(H,M)}else if("p"===o){var h,A=(h=a.substr(1).trim()).split(" ");r.addPointGeometry(A)}else if(null!==(s=Z.exec(a))){var x=(" "+s[0].substr(1).trim()).substr(1);r.startObject(x)}else if(W.test(a))r.object.startMaterial(a.substring(7).trim(),r.materialLibraries);else if(q.test(a))r.materialLibraries.push(a.substring(7).trim());else{if("s"!==o){if("\0"===a)continue;throw new Error('THREE.OBJLoader: Unexpected line: "'+a+'"')}if(1<(s=a.split(" ")).length){var _=s[1].trim().toLowerCase();r.object.smooth="0"!==_&&"off"!==_}else r.object.smooth=!0;var O;(O=r.object.currentMaterial())&&(O.smooth=r.object.smooth)}r.finalize();var N=new THREE.Group;N.materialLibraries=[].concat(r.materialLibraries);for(var c=0,u=r.objects.length;c<u;c++){var P=r.objects[c],C=P.geometry,I=P.materials,F="Line"===C.type,D="Points"===C.type,U=!1;if(0!==C.vertices.length){var G=new THREE.BufferGeometry;G.addAttribute("position",new THREE.Float32BufferAttribute(C.vertices,3)),0<C.normals.length?G.addAttribute("normal",new THREE.Float32BufferAttribute(C.normals,3)):G.computeVertexNormals(),0<C.colors.length&&(U=!0,G.addAttribute("color",new THREE.Float32BufferAttribute(C.colors,3))),0<C.uvs.length&&G.addAttribute("uv",new THREE.Float32BufferAttribute(C.uvs,2));for(var j=[],V=0,k=I.length,B;V<k;V++){var K=I[V],O=void 0;if(null!==this.materials)if(O=this.materials.create(K.name),!F||!O||O instanceof THREE.LineBasicMaterial){if(D&&O&&!(O instanceof THREE.PointsMaterial)){var z=new THREE.PointsMaterial({size:10,sizeAttenuation:!1});THREE.Material.prototype.copy.call(z,O),z.color.copy(O.color),z.map=O.map,z.lights=!1,O=z}}else{var X=new THREE.LineBasicMaterial;THREE.Material.prototype.copy.call(X,O),X.color.copy(O.color),X.lights=!1,O=X}O||((O=F?new THREE.LineBasicMaterial:D?new THREE.PointsMaterial({size:1,sizeAttenuation:!1}):new THREE.MeshPhongMaterial).name=K.name),O.flatShading=!K.smooth,O.vertexColors=U?THREE.VertexColors:THREE.NoColors,j.push(O)}if(1<j.length){for(var V=0,k=I.length;V<k;V++){var K=I[V];G.addGroup(K.groupStart,K.groupCount,V)}B=F?new THREE.LineSegments(G,j):D?new THREE.Points(G,j):new THREE.Mesh(G,j)}else B=F?new THREE.LineSegments(G,j[0]):D?new THREE.Points(G,j[0]):new THREE.Mesh(G,j[0]);B.name=P.name,N.add(B)}}return console.timeEnd("OBJLoader"),N}},e}(),THREE.OrbitControls=function(e,t){function r(){return 2*Math.PI/60/60*F.autoRotateSpeed}function n(){return Math.pow(.95,F.zoomSpeed)}function a(e){K.theta-=e}function o(e){K.phi-=e}function i(e){F.object.isPerspectiveCamera?z/=e:F.object.isOrthographicCamera?(F.object.zoom=Math.max(F.minZoom,Math.min(F.maxZoom,F.object.zoom*e)),F.object.updateProjectionMatrix(),Y=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),F.enableZoom=!1)}function s(e){F.object.isPerspectiveCamera?z*=e:F.object.isOrthographicCamera?(F.object.zoom=Math.max(F.minZoom,Math.min(F.maxZoom,F.object.zoom/e)),F.object.updateProjectionMatrix(),Y=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),F.enableZoom=!1)}function l(e){Z.set(e.clientX,e.clientY)}function c(e){ee.set(e.clientX,e.clientY)}function u(e){J.set(e.clientX,e.clientY)}function p(e){q.set(e.clientX,e.clientY),W.subVectors(q,Z).multiplyScalar(F.rotateSpeed);var t=F.domElement===document?F.domElement.body:F.domElement;a(2*Math.PI*W.x/t.clientHeight),o(2*Math.PI*W.y/t.clientHeight),Z.copy(q),F.update()}function h(e){te.set(e.clientX,e.clientY),re.subVectors(te,ee),0<re.y?i(n()):re.y<0&&s(n()),ee.copy(te),F.update()}function m(e){Q.set(e.clientX,e.clientY),$.subVectors(Q,J).multiplyScalar(F.panSpeed),se($.x,$.y),J.copy(Q),F.update()}function d(e){}function E(e){e.deltaY<0?s(n()):0<e.deltaY&&i(n()),F.update()}function f(e){switch(e.keyCode){case F.keys.UP:se(0,F.keyPanSpeed),F.update();break;case F.keys.BOTTOM:se(0,-F.keyPanSpeed),F.update();break;case F.keys.LEFT:se(F.keyPanSpeed,0),F.update();break;case F.keys.RIGHT:se(-F.keyPanSpeed,0),F.update();break}}function v(e){Z.set(e.touches[0].pageX,e.touches[0].pageY)}function g(e){if(F.enableZoom){var t=e.touches[0].pageX-e.touches[1].pageX,r=e.touches[0].pageY-e.touches[1].pageY,n=Math.sqrt(t*t+r*r);ee.set(0,n)}if(F.enablePan){var a=.5*(e.touches[0].pageX+e.touches[1].pageX),o=.5*(e.touches[0].pageY+e.touches[1].pageY);J.set(a,o)}}function T(e){q.set(e.touches[0].pageX,e.touches[0].pageY),W.subVectors(q,Z).multiplyScalar(F.rotateSpeed);var t=F.domElement===document?F.domElement.body:F.domElement;a(2*Math.PI*W.x/t.clientHeight),o(2*Math.PI*W.y/t.clientHeight),Z.copy(q),F.update()}function R(e){if(F.enableZoom){var t=e.touches[0].pageX-e.touches[1].pageX,r=e.touches[0].pageY-e.touches[1].pageY,n=Math.sqrt(t*t+r*r);te.set(0,n),re.set(0,Math.pow(te.y/ee.y,F.zoomSpeed)),i(re.y),ee.copy(te)}if(F.enablePan){var a=.5*(e.touches[0].pageX+e.touches[1].pageX),o=.5*(e.touches[0].pageY+e.touches[1].pageY);Q.set(a,o),$.subVectors(Q,J).multiplyScalar(F.panSpeed),se($.x,$.y),J.copy(Q)}F.update()}function y(e){}function b(e){if(!1!==F.enabled){switch(e.preventDefault(),e.button){case F.mouseButtons.LEFT:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===F.enablePan)return;u(e),V=j.PAN}else{if(!1===F.enableRotate)return;l(e),V=j.ROTATE}break;case F.mouseButtons.MIDDLE:if(!1===F.enableZoom)return;c(e),V=j.DOLLY;break;case F.mouseButtons.RIGHT:if(!1===F.enablePan)return;u(e),V=j.PAN;break}V!==j.NONE&&(document.addEventListener("mousemove",H,!1),document.addEventListener("mouseup",M,!1),F.dispatchEvent(U))}}function H(e){if(!1!==F.enabled)switch(e.preventDefault(),V){case j.ROTATE:if(!1===F.enableRotate)return;p(e);break;case j.DOLLY:if(!1===F.enableZoom)return;h(e);break;case j.PAN:if(!1===F.enablePan)return;m(e);break}}function M(e){!1!==F.enabled&&(document.removeEventListener("mousemove",H,!1),document.removeEventListener("mouseup",M,!1),F.dispatchEvent(G),V=j.NONE)}function S(e){!1===F.enabled||!1===F.enableZoom||V!==j.NONE&&V!==j.ROTATE||(e.preventDefault(),e.stopPropagation(),F.dispatchEvent(U),E(e),F.dispatchEvent(G))}function L(e){!1!==F.enabled&&!1!==F.enableKeys&&!1!==F.enablePan&&f(e)}function w(e){if(!1!==F.enabled){switch(e.preventDefault(),e.touches.length){case 1:if(!1===F.enableRotate)return;v(e),V=j.TOUCH_ROTATE;break;case 2:if(!1===F.enableZoom&&!1===F.enablePan)return;g(e),V=j.TOUCH_DOLLY_PAN;break;default:V=j.NONE}V!==j.NONE&&F.dispatchEvent(U)}}function A(e){if(!1!==F.enabled)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:if(!1===F.enableRotate)return;if(V!==j.TOUCH_ROTATE)return;T(e);break;case 2:if(!1===F.enableZoom&&!1===F.enablePan)return;if(V!==j.TOUCH_DOLLY_PAN)return;R(e);break;default:V=j.NONE}}function x(e){!1!==F.enabled&&(F.dispatchEvent(G),V=j.NONE)}function _(e){!1!==F.enabled&&e.preventDefault()}var O,N,P,C,I;this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.target=new THREE.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:THREE.MOUSE.LEFT,MIDDLE:THREE.MOUSE.MIDDLE,RIGHT:THREE.MOUSE.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return B.phi},this.getAzimuthalAngle=function(){return B.theta},this.saveState=function(){F.target0.copy(F.target),F.position0.copy(F.object.position),F.zoom0=F.object.zoom},this.reset=function(){F.target.copy(F.target0),F.object.position.copy(F.position0),F.object.zoom=F.zoom0,F.object.updateProjectionMatrix(),F.dispatchEvent(D),F.update(),V=j.NONE},this.update=(O=new THREE.Vector3,N=(new THREE.Quaternion).setFromUnitVectors(e.up,new THREE.Vector3(0,1,0)),P=N.clone().inverse(),C=new THREE.Vector3,I=new THREE.Quaternion,function e(){var t=F.object.position;return O.copy(t).sub(F.target),O.applyQuaternion(N),B.setFromVector3(O),F.autoRotate&&V===j.NONE&&a(r()),B.theta+=K.theta,B.phi+=K.phi,B.theta=Math.max(F.minAzimuthAngle,Math.min(F.maxAzimuthAngle,B.theta)),B.phi=Math.max(F.minPolarAngle,Math.min(F.maxPolarAngle,B.phi)),B.makeSafe(),B.radius*=z,B.radius=Math.max(F.minDistance,Math.min(F.maxDistance,B.radius)),F.target.add(X),O.setFromSpherical(B),O.applyQuaternion(P),t.copy(F.target).add(O),F.object.lookAt(F.target),!0===F.enableDamping?(K.theta*=1-F.dampingFactor,K.phi*=1-F.dampingFactor,X.multiplyScalar(1-F.dampingFactor)):(K.set(0,0,0),X.set(0,0,0)),z=1,!(!(Y||C.distanceToSquared(F.object.position)>k||8*(1-I.dot(F.object.quaternion))>k)||(F.dispatchEvent(D),C.copy(F.object.position),I.copy(F.object.quaternion),Y=!1))}),this.dispose=function(){F.domElement.removeEventListener("contextmenu",_,!1),F.domElement.removeEventListener("mousedown",b,!1),F.domElement.removeEventListener("wheel",S,!1),F.domElement.removeEventListener("touchstart",w,!1),F.domElement.removeEventListener("touchend",x,!1),F.domElement.removeEventListener("touchmove",A,!1),document.removeEventListener("mousemove",H,!1),document.removeEventListener("mouseup",M,!1),window.removeEventListener("keydown",L,!1)};var F=this,D={type:"change"},U={type:"start"},G={type:"end"},j={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY_PAN:4},V=j.NONE,k=1e-6,B=new THREE.Spherical,K=new THREE.Spherical,z=1,X=new THREE.Vector3,Y=!1,Z=new THREE.Vector2,q=new THREE.Vector2,W=new THREE.Vector2,J=new THREE.Vector2,Q=new THREE.Vector2,$=new THREE.Vector2,ee=new THREE.Vector2,te=new THREE.Vector2,re=new THREE.Vector2,ne=(ae=new THREE.Vector3,function e(t,r){ae.setFromMatrixColumn(r,0),ae.multiplyScalar(-t),X.add(ae)}),ae,oe=(ie=new THREE.Vector3,function e(t,r){!0===F.screenSpacePanning?ie.setFromMatrixColumn(r,1):(ie.setFromMatrixColumn(r,0),ie.crossVectors(F.object.up,ie)),ie.multiplyScalar(t),X.add(ie)}),ie,se=(le=new THREE.Vector3,function e(t,r){var n=F.domElement===document?F.domElement.body:F.domElement;if(F.object.isPerspectiveCamera){var a=F.object.position;le.copy(a).sub(F.target);var o=le.length();o*=Math.tan(F.object.fov/2*Math.PI/180),ne(2*t*o/n.clientHeight,F.object.matrix),oe(2*r*o/n.clientHeight,F.object.matrix)}else F.object.isOrthographicCamera?(ne(t*(F.object.right-F.object.left)/F.object.zoom/n.clientWidth,F.object.matrix),oe(r*(F.object.top-F.object.bottom)/F.object.zoom/n.clientHeight,F.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),F.enablePan=!1)}),le;F.domElement.addEventListener("contextmenu",_,!1),F.domElement.addEventListener("mousedown",b,!1),F.domElement.addEventListener("wheel",S,!1),F.domElement.addEventListener("touchstart",w,!1),F.domElement.addEventListener("touchend",x,!1),F.domElement.addEventListener("touchmove",A,!1),window.addEventListener("keydown",L,!1),this.update()},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.OrbitControls.prototype.constructor=THREE.OrbitControls,Object.defineProperties(THREE.OrbitControls.prototype,{center:{get:function e(){return console.warn("THREE.OrbitControls: .center has been renamed to .target"),this.target}},noZoom:{get:function e(){return console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function e(t){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!t}},noRotate:{get:function e(){return console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function e(t){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!t}},noPan:{get:function e(){return console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function e(t){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!t}},noKeys:{get:function e(){return console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function e(t){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!t}},staticMoving:{get:function e(){return console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.enableDamping},set:function e(t){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.enableDamping=!t}},dynamicDampingFactor:{get:function e(){return console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor},set:function e(t){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor=t}}}),THREE.CannonDebugRenderer=function(e,t,r){r=r||{},this.scene=e,this.world=t,this._meshes=[],this._material=new THREE.MeshBasicMaterial({color:65280,wireframe:!0}),this._sphereGeometry=new THREE.SphereGeometry(1),this._boxGeometry=new THREE.BoxGeometry(1,1,1),this._planeGeometry=new THREE.PlaneGeometry(10,10,10,10),this._cylinderGeometry=new THREE.CylinderGeometry(1,1,10,10)},THREE.CannonDebugRenderer.prototype={tmpVec0:new CANNON.Vec3,tmpVec1:new CANNON.Vec3,tmpVec2:new CANNON.Vec3,tmpQuat0:new CANNON.Vec3,update:function e(){for(var t=this.world.bodies,r=this._meshes,n=this.tmpVec0,a=this.tmpQuat0,o=0,i=0;i!==t.length;i++)for(var s=t[i],l=0;l!==s.shapes.length;l++){var c=s.shapes[l],u;this._updateMesh(o,s,c),(u=r[o])&&(s.quaternion.vmult(s.shapeOffsets[l],n),s.position.vadd(n,n),s.quaternion.mult(s.shapeOrientations[l],a),u.position.copy(n),u.quaternion.copy(a)),o++}for(var i=o;i<r.length;i++){var u;(u=r[i])&&this.scene.remove(u)}r.length=o},_updateMesh:function e(t,r,n){var a=this._meshes[t];this._typeMatch(a,n)||(a&&this.scene.remove(a),a=this._meshes[t]=this._createMesh(n)),this._scaleMesh(a,n)},_typeMatch:function e(t,r){if(!t)return!1;var n=t.geometry;return n instanceof THREE.SphereGeometry&&r instanceof CANNON.Sphere||n instanceof THREE.BoxGeometry&&r instanceof CANNON.Box||n instanceof THREE.PlaneGeometry&&r instanceof CANNON.Plane||n.id===r.geometryId&&r instanceof CANNON.ConvexPolyhedron||n.id===r.geometryId&&r instanceof CANNON.Trimesh||n.id===r.geometryId&&r instanceof CANNON.Heightfield},_createMesh:function e(t){var r,n=this._material;switch(t.type){case CANNON.Shape.types.SPHERE:r=new THREE.Mesh(this._sphereGeometry,n);break;case CANNON.Shape.types.BOX:r=new THREE.Mesh(this._boxGeometry,n);break;case CANNON.Shape.types.PLANE:r=new THREE.Mesh(this._planeGeometry,n);break;case CANNON.Shape.types.CONVEXPOLYHEDRON:for(var a=new THREE.Geometry,o=0;o<t.vertices.length;o++){var i=t.vertices[o];a.vertices.push(new THREE.Vector3(i.x,i.y,i.z))}for(var o=0;o<t.faces.length;o++)for(var s=t.faces[o],l=s[0],c=1;c<s.length-1;c++){var u=s[c],p=s[c+1];a.faces.push(new THREE.Face3(l,u,p))}a.computeBoundingSphere(),a.computeFaceNormals(),r=new THREE.Mesh(a,n),t.geometryId=a.id;break;case CANNON.Shape.types.TRIMESH:for(var h=new THREE.Geometry,m=this.tmpVec0,d=this.tmpVec1,E=this.tmpVec2,o=0;o<t.indices.length/3;o++){t.getTriangleVertices(o,m,d,E),h.vertices.push(new THREE.Vector3(m.x,m.y,m.z),new THREE.Vector3(d.x,d.y,d.z),new THREE.Vector3(E.x,E.y,E.z));var c=h.vertices.length-3;h.faces.push(new THREE.Face3(c,c+1,c+2))}h.computeBoundingSphere(),h.computeFaceNormals(),r=new THREE.Mesh(h,n),t.geometryId=h.id;break;case CANNON.Shape.types.HEIGHTFIELD:for(var h=new THREE.Geometry,m=this.tmpVec0,d=this.tmpVec1,E=this.tmpVec2,f=0;f<t.data.length-1;f++)for(var v=0;v<t.data[f].length-1;v++)for(var g=0;g<2;g++){t.getConvexTrianglePillar(f,v,0===g),m.copy(t.pillarConvex.vertices[0]),d.copy(t.pillarConvex.vertices[1]),E.copy(t.pillarConvex.vertices[2]),m.vadd(t.pillarOffset,m),d.vadd(t.pillarOffset,d),E.vadd(t.pillarOffset,E),h.vertices.push(new THREE.Vector3(m.x,m.y,m.z),new THREE.Vector3(d.x,d.y,d.z),new THREE.Vector3(E.x,E.y,E.z));var o=h.vertices.length-3;h.faces.push(new THREE.Face3(o,o+1,o+2))}h.computeBoundingSphere(),h.computeFaceNormals(),r=new THREE.Mesh(h,n),t.geometryId=h.id;break}return r&&this.scene.add(r),r},_scaleMesh:function e(t,r){switch(r.type){case CANNON.Shape.types.SPHERE:var n=r.radius;t.scale.set(n,n,n);break;case CANNON.Shape.types.BOX:t.scale.copy(r.halfExtents),t.scale.multiplyScalar(2);break;case CANNON.Shape.types.CONVEXPOLYHEDRON:t.scale.set(1,1,1);break;case CANNON.Shape.types.TRIMESH:t.scale.copy(r.scale);break;case CANNON.Shape.types.HEIGHTFIELD:t.scale.set(1,1,1);break}}};
//# sourceMappingURL=libs.js.map