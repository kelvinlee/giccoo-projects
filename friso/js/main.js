// Generated by CoffeeScript 1.12.7
var ANIMATION_END_NAME, ANIMATION_END_NAMES, IsPC, Loader, SendNote, Store, TRANSITION_END_NAME, TRANSITION_END_NAMES, VENDORS, _loader, css3Prefix, defaultInfo, defaultTop, getdefaultTop, i, j, len, loadWechatConfig, mTestElement, qrcode, scrollTop, shareContent, updateLoad;

VENDORS = ["Moz", 'webkit', 'ms', 'O'];

TRANSITION_END_NAMES = {
  "Moz": "transitionend",
  "webkit": "webkitTransitionEnd",
  "ms": "MSTransitionEnd",
  "O": "oTransitionEnd"
};

ANIMATION_END_NAMES = {
  "Moz": "animationend",
  "webkit": "webkitAnimationEnd",
  "ms": "MSAnimationEnd",
  "O": "oAnimationEnd"
};

mTestElement = document.createElement("div");

for (j = 0, len = VENDORS.length; j < len; j++) {
  i = VENDORS[j];
  css3Prefix = i;
  if ((css3Prefix + "Transition") in mTestElement.style) {
    break;
  }
  css3Prefix = false;
}

if (css3Prefix) {
  TRANSITION_END_NAME = TRANSITION_END_NAMES[css3Prefix];
  ANIMATION_END_NAME = ANIMATION_END_NAMES[css3Prefix];
}

(function() {
  var lastTime, vendors, x;
  lastTime = 0;
  vendors = ["webkit", "moz"];
  x = 0;
  while (x > vendors.length && !window.requestAnimationFrame) {
    console.log("" + vendors[x]);
  }
  window.requestAnimationFrame = window[vendors[x] + "RequestAnimationFrame"];
  window.cancelAnimationFrame = window[vendors[x] + "CancelAnimationFrame"] || window[vendors[x] + "CancelRequestAnimationFrame"];
  ++x;
  if (!window.requestAnimationFrame) {
    window.requestAnimationFrame = function(callback, element) {
      var currTime, id, timeToCall;
      currTime = new Date().getTime();
      timeToCall = Math.max(0, 16.7 - (currTime - lastTime));
      id = window.setTimeout(function() {
        callback(currTime + timeToCall);
      }, timeToCall);
      lastTime = currTime + timeToCall;
      return id;
    };
  }
  if (!window.cancelAnimationFrame) {
    window.cancelAnimationFrame = function(id) {
      clearTimeout(id);
    };
  }
})();

qrcode = function() {
  return (function() {
    var hm, s;
    hm = document.createElement('script');
    hm.onload = function() {
      return new QRCode(document.getElementById("qrcode"), {
        width: 400,
        height: 400,
        text: window.location.href
      });
    };
    hm.src = '/libs/js/min/qrcode.min.js';
    s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(hm, s);
  })();
};

Store = {};

scrollTop = 0;

defaultTop = 0;

getdefaultTop = false;

shareContent = {
  title: "知乎·北鼻版",
  desc: "小宝宝的问题千奇百怪，又萌又天真。如果有一个「知乎北鼻版」 会发生神马?",
  link: "http://m.giccoo.com/friso/",
  imgUrl: "http://m.giccoo.com/friso/img/share.jpg",
  success: function() {},
  cancel: function() {}
};

defaultInfo = localStorage.getItem("defaultInfo") ? JSON.parse(localStorage.getItem("defaultInfo")) : [
  {
    id: 1,
    question: '我们喝了奶牛妈妈的奶，小牛会伤心吗?',
    answer1: '奶牛妈妈有很多奶，多到小牛吃不完。在荷兰菲仕兰农场里，农夫精心照顾奶牛妈妈和小牛，就像一家人一样。农夫还会拿自己的手指给小牛练习吸奶的动作，所以奶牛妈妈和小牛一定乐意分享牛奶给家人……',
    answer1by: '嗷小明',
    answer1img: null,
    answer2: '因为小牛学会了分享啊，他把自己喝的牛奶分享给你，你也要学会分享，把自己的东西分享给别的小朋友。',
    answer2by: '不吃栗子',
    answer2img: null,
    answer3: null,
    answer3by: null,
    answer3img: null,
    like: 0,
    focus: 420,
    answers: 47,
    link: 'https://www.zhihu.com/question/65373045'
  }, {
    id: 2,
    question: '为什么喝完牛奶之后会有白胡子？',
    answer1: '因为牛奶亲了你一下吖',
    answer1by: '左左',
    answer1img: null,
    answer2: '小小的白胡子是牛奶中的营养精华的天然乳脂，它比水分子有更强的吸附力，沾在嘴边就变成宝宝的小白胡子啦。皇家美素佳儿奶粉保留了牛奶中的这一道天然营养精华，所以宝宝喝的时候一定要舔干净哟。',
    answer2by: '大球球',
    answer2img: null,
    answer3: null,
    answer3by: null,
    answer3img: null,
    like: 0,
    focus: 160,
    answers: 33,
    link: 'https://www.zhihu.com/question/65372977'
  }, {
    id: 3,
    question: '我喝的奶粉为什么有妈妈的味道？',
    answer1: '是爱的味道呀～',
    answer1by: '莫小莫姑娘',
    answer1img: null,
    answer2: '妈妈的味道，其实就是新鲜牛奶和皇家美素佳儿奶粉中天然乳脂的味道，天然乳脂含有丰富的天然营养精华，更加自然接近母乳，当然就有妈妈的味道啦。',
    answer2by: 'xiaochu',
    answer2img: null,
    answer3: null,
    answer3by: null,
    answer3img: null,
    like: 0,
    focus: 130,
    answers: 19,
    link: 'https://www.zhihu.com/question/65373089'
  }, {
    id: 4,
    question: '大象走路的时候，会不会踩到自己的鼻子？',
    answer1: '小象可能会踩到的，就像是我们小时候走路老容易摔跤，后来多踩几次就会有经验了，知道脚和鼻子怎么配合了。等小象变成大象了，再踩到的机会就少了。',
    answer1by: '哇哈哈',
    answer1img: null,
    answer2: '会，所以大象妈妈告诉小象要抬头挺胸快快长高，宝宝也是哦！',
    answer2by: '皇家美素佳儿',
    answer2img: null,
    answer3: null,
    answer3by: null,
    answer3img: null,
    like: 0,
    focus: 215,
    answers: 28,
    link: 'https://www.zhihu.com/question/65373183'
  }, {
    id: 5,
    question: '妈妈，你的肚子里有厕所吗？',
    answer1: '妈妈的肚子很神奇，什么都有。有棒棒糖，西瓜，菠萝，大鸡腿，烤鸭，麻辣烫，火锅…很多好吃的～有好玩的，变形金刚，洋娃娃，游乐场…很多好玩的～',
    answer1by: '郭羽靖',
    answer1img: null,
    answer2: '宝宝你在妈妈肚子里还不会上厕所，等你出生之后小肚肚才开始学会生产便便的，它跟你一样还小，所以现在你要喝皇家美素佳儿，好好保护它。',
    answer2by: '骆驼君',
    answer2img: null,
    answer3: null,
    answer3by: null,
    answer3img: null,
    like: 0,
    focus: 197,
    answers: 12,
    link: 'https://www.zhihu.com/question/65375080'
  }, {
    id: 6,
    question: '我的眼睛很小，怎么能看到那么大的世界？',
    answer1: '宝贝你站得越高就会看得越远，你看到的世界也会越大哦，如果你像航天员叔叔们站到外太空看世界的话，那你能看清楚整个世界哦~',
    answer1by: 'SK英国皇家成长中心',
    answer1img: null,
    answer2: '皇家美素佳儿帮助宝宝快快长高，让小眼睛看到更大的世界。',
    answer2by: '皇家美素佳儿',
    answer2img: null,
    answer3: null,
    answer3by: null,
    answer3img: null,
    like: 0,
    focus: 190,
    answers: 29,
    link: 'https://www.zhihu.com/question/65340831'
  }, {
    id: 7,
    question: '长颈鹿冬天要戴多长的围巾？',
    answer1: '－长颈鹿冬天只要戴正常长度但是好看的围巾。因为围巾不是用来保暖的，是用来搭配的～',
    answer1by: ' 何方',
    answer1img: null,
    answer2: '喝皇家美素佳儿才能跟长颈鹿一样快快长高哦！',
    answer2by: '皇家美素佳儿',
    answer2img: null,
    answer3: null,
    answer3by: null,
    answer3img: null,
    like: 0,
    focus: 178,
    answers: 28,
    link: 'https://www.zhihu.com/question/65373153'
  }, {
    id: 8,
    question: '屁是一个泡泡嘛？它为什么臭臭的额，还会尖叫？',
    answer1: '屁啊～是你肚子里的食物的最后叹息。有的食物很开心地分解了，有的有些不高兴，所以叹气是臭臭的。肚子里站岗警察在赶走他们的时候，他们还会发出尖叫声。 ',
    answer1by: '郭羽靖',
    answer1img: null,
    answer2: '好吸收的皇家美素佳儿奶粉，守护宝宝由内而外身体强健，延续妈妈爱的力量，陪伴宝宝珍贵成长。',
    answer2by: '皇家美素佳儿',
    answer2img: null,
    answer3: null,
    answer3by: null,
    answer3img: null,
    like: 0,
    focus: 180,
    answers: 10,
    link: 'https://www.zhihu.com/question/65341250'
  }, {
    id: 9,
    question: '给蛇打结，它会和我一样聪明地解开吗？',
    answer1: '你解开结是解开了另一个东西，而蛇是舒展自己的身体，让它回到让自己舒服的状态，就像你盘腿坐，然后把腿伸直一样自然，不难~',
    answer1by: ' 嗷呜',
    answer1img: null,
    answer2: '皇家美素佳儿助力宝宝骨骼发育，像小蛇宝宝一样健康灵活、舒展自如。',
    answer2by: '皇家美素佳儿',
    answer2img: null,
    answer3: null,
    answer3by: null,
    answer3img: null,
    like: 0,
    focus: 159,
    answers: 28,
    link: 'https://www.zhihu.com/question/65373216'
  }, {
    id: 10,
    question: '世界上哪里的小朋友最高？',
    answer1: '勇于承认错误的小盆友最高，因为勇气； 乐观开朗的小盆友最高，因为心态；',
    answer1by: '婗同学',
    answer1img: null,
    answer2: '荷兰的勇敢乐观开朗的小朋友最高，因为皇家美素佳儿。',
    answer2by: '皇家美素佳儿',
    answer2img: null,
    answer3: null,
    answer3by: null,
    answer3img: null,
    like: 0,
    focus: 154,
    answers: 19,
    link: 'https://www.zhihu.com/question/65342493'
  }
];

riot.mount("*");

updateLoad = function() {
  return $.ajax({
    type: "get",
    url: "http://api.giccoo.com/friso/list/",
    dataType: 'json',
    data: null,
    success: function(msg) {
      if (msg.list.length > 1) {
        defaultInfo = msg.list;
        localStorage.setItem("defaultInfo", JSON.stringify(defaultInfo));
        Store.friso.updateContents(defaultInfo);
        return console.log("update loaded");
      }
    },
    error: function(error) {}
  });
};

window.onscroll = function(evt) {
  var top;
  top = document.scrollingElement.scrollTop;
  if (getdefaultTop && (top > defaultTop)) {
    return $(".logo").addClass("scroll");
  } else {
    return $(".logo").removeClass("scroll");
  }
};

window.onload = function() {
  var MK;
  MK = $("body").width() / $("body").height();
  defaultTop = $(".logo").offset().top;
  getdefaultTop = true;
  if ($("body").height() <= 460 || MK > 0.65) {
    $("body").addClass("iphone4");
  }
  $(".q-list").on("click", ".title", function(evt) {
    if ($(this).parent().is(".on")) {
      return $(this).parent().removeClass("on");
    } else {
      return $(this).parent().addClass("on");
    }
  });
  $(".main .logo").on("click", function(evt) {
    scrollTop = document.scrollingElement.scrollTop;
    document.body.style.top = -scrollTop + 'px';
    $("body").addClass("pop-open");
    $(".pop").addClass("on");
    return _hmt.push(['_trackEvent', "friso", "移动端浮层", "打开", "-"]);
  });
  $(".pop .close").on("click", function(evt) {
    $("body").removeClass("pop-open");
    $(".pop").removeClass("on");
    document.scrollingElement.scrollTop = scrollTop;
    document.body.style.top = 0;
    return _hmt.push(['_trackEvent', "friso", "移动端浮层", "关闭", "-"]);
  });
  $(".main,.pop").on("click", "a", function(evt) {
    var self;
    _hmt.push(['_trackEvent', "friso", "页面外跳", "" + $(this).attr("href"), "-"]);
    self = this;
    return setTimeout(function() {
      return window.location.href = $(self).attr("href");
    }, 10);
  });
  if (IsPC() && $(".main").is(".mobile")) {
    return window.location.href = "pc.html";
  }
  updateLoad();
  if (typeof wx !== "undefined" && wx !== null) {
    console.log("load wx");
    wx.ready(function() {
      wx.onMenuShareTimeline(shareContent);
      wx.onMenuShareAppMessage(shareContent);
      wx.onMenuShareQQ(shareContent);
      return wx.onMenuShareWeibo(shareContent);
    });
    loadWechatConfig();
  }
  return true;
};

IsPC = function() {
  var Agents, flag, userAgentInfo, v;
  userAgentInfo = navigator.userAgent;
  Agents = new Array('Android', 'iPhone', 'SymbianOS', 'Windows Phone', 'iPad', 'iPod');
  flag = true;
  v = 0;
  while (v < Agents.length) {
    if (userAgentInfo.indexOf(Agents[v]) > 0) {
      flag = false;
      break;
    }
    v++;
  }
  return flag;
};

loadWechatConfig = function() {
  var hm, s, url;
  url = encodeURIComponent(window.location.href.split("#")[0]);
  hm = document.createElement('script');
  hm.src = "http://api.giccoo.com/api/config?url=" + url;
  s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(hm, s);
};

SendNote = function(msg, time) {
  if (time == null) {
    time = 3000;
  }
  $("body").append("<note title='" + msg + ("' time='" + time + "'></note>"));
  return riot.mount("note");
};

_loader = {};

Loader = function(id, title, type, time, more) {
  if (title == null) {
    title = "";
  }
  if (type == null) {
    type = "ball";
  }
  if (time == null) {
    time = 0;
  }
  if (more == null) {
    more = "";
  }
  if ($("#" + id).length > 0) {
    return _loader[id].loadend();
  }
  $("body").append("<loader id='" + id + "' title='" + title + "' type='" + type + ("' time='" + time + "'>" + more + "</loader>"));
  return riot.mount("loader");
};
