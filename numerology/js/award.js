"use strict";var _updateNames,apiURL,ask,ask_award,ask_my,ask_update,awardBox,awardPop,gameFailUpdateShareContent,initAward,initNote,initPlayer,initPop,myAward,myCount,note,openAward,player,shareContent,updateShareContent;apiURL="api.giccoo.com",axios.defaults.withCredentials=!0,_updateNames={game1:!1,game2:!1,game3:!1,share:!1},awardPop={},awardBox={},myCount=0,myAward=0,note={},player={},shareContent={title:"千奇百怪，奇乐无穷。12月14日《奇门遁甲》全国首映，侠客天团热血登场，与雾隐门一起大战天外来妖！",desc:"千奇百怪，奇乐无穷，12月14日，燃情上映！",link:"http://m.giccoo.com/numerology/",imgUrl:"http://m.giccoo.com/numerology/img/ico.jpg",success:function t(){return ask_update(3)},cancel:function t(){}},window.onload=function(){var t,e;return e=document.getElementsByTagName("body")[0],t=e.offsetWidth/e.offsetHeight,(e.offsetHeight<=480||t>.65)&&(e.className="iphone4"),e.offsetWidth>=640&&(e.className="pc"),ask(function(t){var e;return console.log(t),e=0,null!=t.info&&(myCount=t.info.count,myAward=t.info.award,e=t.info.count-t.info.award),initAward(e),initPop(),initNote(),initPlayer()})},initPlayer=function t(){return player=new Vue({el:"#bgmCtrl",data:{audio:null,src:"./mp3/bgm.mp3",playing:!1,stoped:!1,iconPlay:"http://image.giccoo.com/projects/libs/img/audio-stop.png",iconStop:"http://image.giccoo.com/projects/libs/img/audio-play.png"},methods:{play:function t(){return this.playing=!0},pause:function t(){return this.playing=!1},change:function t(){return this.playing?(this.audio.pause(),this.stoped=!0):(this.audio.play(),this.stoped=!1)}},computed:{iconNow:function t(){return this.playing?this.iconStop:this.iconPlay}},mounted:function t(e){return this.audio=document.getElementById("bgm"),console.log("audio:",this.audio),this.audio.addEventListener("pause",this.pause.bind(this)),this.audio.addEventListener("play",this.play.bind(this))}})},openAward=function t(){return $("#award").fadeIn()},initAward=function t(e){return awardBox=new Vue({el:"#award",data:{start:!1,times:e,boxClass:"on",awarding:!1},methods:{go:function t(){var e;return!this.awarding&&(myCount<=0?(note.send("你未达到抽奖资格<br/>分享到朋友圈可获得一次抽奖机会！"),!1):myAward>=4?(note.send("啊哦~今日抽奖机会已经全部用完，明天再来战！"),!1):this.times<=0?(note.send("参加游戏或分享活动获得抽奖次数"),!1):(e=this,this.times-1>=0&&(this.times=this.times-1),myAward++,this.awarding=!0,ask_award(function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none",a=arguments[2];return 200===t?(e.boxClass="open "+n,setTimeout(function(){return awardPop.type=n,awardPop.success=!0,awardPop.code=a,awardBox.awarding=!1,$("#award-over").fadeIn(),document.getElementById("zhongjiang").play()},3500)):(e.boxClass="open none",setTimeout(function(){return awardPop.success=!1,awardBox.awarding=!1,$("#award-over").fadeIn()},3500))})))},my:function t(){return ask_my(function(t){return console.log(t[0]),t.length>0?(awardPop.success=!0,awardPop.type=t[0].type,awardPop.code=t[0].code,$("#award-over").fadeIn()):(awardPop.success=!1,$("#award-over").fadeIn())})},back:function t(){return $("#award").fadeOut(),resetGame()},default:function t(){return this.boxClass="on"}}})},initNote=function t(){return note=new Vue({el:"#note",data:{notetext:"",showtime:4e3,timeout:null,show:!1,boxshow:!1},methods:{close:function t(){return clearTimeout(this.timeout),this.show=!1,this.boxshow=!1},send:function t(e){var n;return clearTimeout(this.timeout),n=this,n.notetext=e,n.show=!0,this.boxshow=!0}}})},initPop=function t(){return awardPop=new Vue({el:"#award-over",data:{how:!1,success:!1,share:!1,type:"ticket",code:"none"},methods:{openHow:function t(){return this.how=!this.how},openShare:function t(){return this.share=!this.share},close:function t(){return awardBox.default(),$("#award-over").fadeOut()}}})},ask=function t(e){return axios.get("http://"+apiURL+"/wechat/numerology/ask/").then(function(t){return console.log("msg:",t.data),200===t.data.recode?e(t.data):window.location.href="https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx15cc4d73cb0b6437&redirect_uri={url}&response_type=code&scope=snsapi_base&state=123#wechat_redirect".replace("{url}",encodeURIComponent("http://"+apiURL+"/wechat/numerology/"))}).catch(function(t){})},ask_update=function t(e){var n,a;return a=["game1","game2","game3","share"],n=a[e],e<3&&(0===e&&(shareContent.title="原来我的江湖绝学是“千里眼”！快来与我一起勇闯热血江湖！"),1===e&&(shareContent.title="原来我的江湖绝学是“顺风耳”！快来与我一起勇闯热血江湖！"),2===e&&(shareContent.title="原来我的江湖绝学是“霹雳火”！快来与我一起勇闯热血江湖！"),updateShareContent(shareContent)),!_updateNames[n]&&(myCount++,axios.get("http://"+apiURL+"/wechat/numerology/update/").then(function(t){return console.log("msg:",t.data),200===t.data.recode?(_updateNames[n]=!0,awardBox.times=awardBox.times+1):201===t.data.recode?note.send("请使用微信打开此页面参与活动"):void 0}).catch(function(t){return note.send("服务器请求失败,请重试")}))},ask_award=function t(e){return axios.get("http://"+apiURL+"/wechat/numerology/award/").then(function(t){return console.log("msg:",t.data),200===t.data.recode?e(200,t.data.info.type,t.data.info.code):301===t.data.recode?e(301):note.send(t.data.reason)}).catch(function(t){return note.send("服务器请求失败,请重试")})},ask_my=function t(e){return axios.get("http://"+apiURL+"/wechat/numerology/my/").then(function(t){return console.log("msg:",t.data),200===t.data.recode?e(t.data.info):note.send(t.data.reason)}).catch(function(t){return note.send("服务器请求失败,请重试")})},gameFailUpdateShareContent=function t(){return shareContent.title="侠士，妖人祸国，遁甲现世，快来与我一起除魔卫道！",updateShareContent(shareContent)},updateShareContent=function t(e){return console.log(e),wx.onMenuShareTimeline(e),wx.onMenuShareAppMessage(e),wx.onMenuShareQQ(e),wx.onMenuShareWeibo(e)};