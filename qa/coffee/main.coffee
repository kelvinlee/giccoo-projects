# @codekit-prepend "coffee/css3Prefix"
# @codekit-prepend "coffee/plus"
# @codekit-prepend "../../libs/coffee/requestanimation"

_citys = {}
_citys["保险集团控股公司"] = []
_citys["保险集团控股公司"].push("中国人民保险集团股份有限公司")
_citys["保险集团控股公司"].push("中国太平保险集团有限责任公司")
_citys["保险集团控股公司"].push("中国人寿保险（集团）公司")
_citys["保险集团控股公司"].push("安邦保险集团股份有限公司")
_citys["保险集团控股公司"].push("中国再保险（集团）股份有限公司")
_citys["保险集团控股公司"].push("阳光保险集团股份有限公司")
_citys["保险集团控股公司"].push("中国太平洋保险（集团）股份有限公司")
_citys["保险集团控股公司"].push("中华联合保险控股股份有限公司")
_citys["保险集团控股公司"].push("中国平安保险（集团）股份有限公司")
_citys["保险集团控股公司"].push("富德保险控股股份有限公司")
_citys["保险集团控股公司"].push("华泰保险集团股份有限公司")

_citys["保险公司－人身险"] = []
_citys["保险公司－人身险"].push("中国人寿保险股份有限公司")
_citys["保险公司－人身险"].push("中国太平洋人寿保险股份有限公司")
_citys["保险公司－人身险"].push("中国平安人寿保险股份有限公司")
_citys["保险公司－人身险"].push("新华人寿保险股份有限公司")
_citys["保险公司－人身险"].push("泰康人寿保险股份有限公司")
_citys["保险公司－人身险"].push("太平人寿保险有限公司")
_citys["保险公司－人身险"].push("中宏人寿保险有限公司")
_citys["保险公司－人身险"].push("建信人寿保险有限公司")
_citys["保险公司－人身险"].push("中德安联人寿保险有限公司")
_citys["保险公司－人身险"].push("工银安盛人寿保险有限公司")
_citys["保险公司－人身险"].push("友邦保险有限公司江门支公司")
_citys["保险公司－人身险"].push("友邦保险有限公司东莞支公司")
_citys["保险公司－人身险"].push("北大方正人寿保险有限公司")
_citys["保险公司－人身险"].push("中荷人寿保险有限公司")
_citys["保险公司－人身险"].push("中英人寿保险有限公司")
_citys["保险公司－人身险"].push("同方全球人寿保险有限公司")
_citys["保险公司－人身险"].push("民生人寿保险股份有限公司")
_citys["保险公司－人身险"].push("招商信诺人寿保险有限公司")
_citys["保险公司－人身险"].push("长生人寿保险有限公司")
_citys["保险公司－人身险"].push("恒安标准人寿保险有限公司")
_citys["保险公司－人身险"].push("中美联泰大都会人寿保险有限公司")
_citys["保险公司－人身险"].push("平安健康保险股份有限公司")
_citys["保险公司－人身险"].push("中国人民健康保险股份有限公司")
_citys["保险公司－人身险"].push("华夏人寿保险股份有限公司")
_citys["保险公司－人身险"].push("中银三星人寿保险有限公司")
_citys["保险公司－人身险"].push("君康人寿保险股份有限公司")
_citys["保险公司－人身险"].push("信泰人寿保险股份有限公司")
_citys["保险公司－人身险"].push("农银人寿保险股份有限公司")
_citys["保险公司－人身险"].push("长城人寿保险股份有限公司")
_citys["保险公司－人身险"].push("昆仑健康保险股份有限公司")
_citys["保险公司－人身险"].push("新光海航人寿保险有限责任公司")
_citys["保险公司－人身险"].push("汇丰人寿保险有限公司")
_citys["保险公司－人身险"].push("君龙人寿保险有限公司")
_citys["保险公司－人身险"].push("百年人寿保险股份有限公司")
_citys["保险公司－人身险"].push("中邮人寿保险股份有限公司")
_citys["保险公司－人身险"].push("中融人寿保险股份有限公司")
_citys["保险公司－人身险"].push("安邦人寿保险股份有限公司")
_citys["保险公司－人身险"].push("利安人寿保险股份有限公司")
_citys["保险公司－人身险"].push("华汇人寿保险股份有限公司")
_citys["保险公司－人身险"].push("前海人寿保险股份有限公司")
_citys["保险公司－人身险"].push("信诚人寿保险有限公司")
_citys["保险公司－人身险"].push("交银康联人寿保险有限公司")
_citys["保险公司－人身险"].push("天安人寿保险股份有限公司")
_citys["保险公司－人身险"].push("中意人寿保险有限公司")
_citys["保险公司－人身险"].push("光大永明人寿保险有限公司")
_citys["保险公司－人身险"].push("友邦保险有限公司北京分公司")
_citys["保险公司－人身险"].push("友邦保险有限公司上海分公司")
_citys["保险公司－人身险"].push("友邦保险有限公司江苏分公司")
_citys["保险公司－人身险"].push("友邦保险有限公司广东分公司")
_citys["保险公司－人身险"].push("友邦保险有限公司深圳分公司")
_citys["保险公司－人身险"].push("瑞泰人寿保险有限公司")
_citys["保险公司－人身险"].push("富德生命人寿保险股份有限公司")
_citys["保险公司－人身险"].push("中美大都会人寿保险有限公司")
_citys["保险公司－人身险"].push("东方人寿保险股份有限公司")
_citys["保险公司－人身险"].push("中法人寿保险有限责任公司")
_citys["保险公司－人身险"].push("平安养老保险股份有限公司")
_citys["保险公司－人身险"].push("合众人寿保险股份有限公司")
_citys["保险公司－人身险"].push("华泰人寿保险股份有限公司")
_citys["保险公司－人身险"].push("陆家嘴国泰人寿保险有限责任公司")
_citys["保险公司－人身险"].push("太平养老保险股份有限公司")
_citys["保险公司－人身险"].push("和谐健康保险股份有限公司")
_citys["保险公司－人身险"].push("中国人民人寿保险股份有限公司")
_citys["保险公司－人身险"].push("国华人寿保险股份有限公司")
_citys["保险公司－人身险"].push("中新大东方人寿保险有限公司")
_citys["保险公司－人身险"].push("中国人寿养老保险股份有限公司")
_citys["保险公司－人身险"].push("长江养老保险股份有限公司")
_citys["保险公司－人身险"].push("英大泰和人寿保险股份有限公司")
_citys["保险公司－人身险"].push("泰康养老保险股份有限公司")
_citys["保险公司－人身险"].push("幸福人寿保险股份有限公司")
_citys["保险公司－人身险"].push("阳光人寿保险股份有限公司")
_citys["保险公司－人身险"].push("上海人寿保险股份有限公司")
_citys["保险公司－人身险"].push("东吴人寿保险股份有限公司")
_citys["保险公司－人身险"].push("弘康人寿保险股份有限公司")
_citys["保险公司－人身险"].push("吉祥人寿保险股份有限公司")
_citys["保险公司－人身险"].push("复星保德信人寿保险有限公司")
_citys["保险公司－人身险"].push("中韩人寿保险有限公司")
_citys["保险公司－人身险"].push("德华安顾人寿保险有限公司")
_citys["保险公司－人身险"].push("安邦养老保险股份有限公司")
_citys["保险公司－人身险"].push("太保安联健康保险股份有限公司")
_citys["保险公司－人身险"].push("渤海人寿保险股份有限公司")
_citys["保险公司－人身险"].push("国联人寿保险股份有限公司")

_citys["保险公司－财产险"] = []
_citys["保险公司－财产险"].push("中国人民财产保险股份有限公司")
_citys["保险公司－财产险"].push("中国大地财产保险股份有限公司")
_citys["保险公司－财产险"].push("中国出口信用保险公司")
_citys["保险公司－财产险"].push("中华联合财产保险股份有限公司")
_citys["保险公司－财产险"].push("中国太平洋财产保险股份有限公司")
_citys["保险公司－财产险"].push("中国平安财产保险股份有限公司")
_citys["保险公司－财产险"].push("天安财产保险股份有限公司")
_citys["保险公司－财产险"].push("史带财产保险股份有限公司")
_citys["保险公司－财产险"].push("华安财产保险股份有限公司")
_citys["保险公司－财产险"].push("永安财产保险股份有限公司")
_citys["保险公司－财产险"].push("安联财产保险（中国）有限公司")
_citys["保险公司－财产险"].push("日本财产保险（中国）有限公司")
_citys["保险公司－财产险"].push("利宝保险有限公司")
_citys["保险公司－财产险"].push("安信农业保险股份有限公司")
_citys["保险公司－财产险"].push("中航安盟财产保险有限公司")
_citys["保险公司－财产险"].push("永诚财产保险股份有限公司")
_citys["保险公司－财产险"].push("安华农业保险股份有限公司")
_citys["保险公司－财产险"].push("安盛天平财产保险股份有限公司")
_citys["保险公司－财产险"].push("阳光财产保险股份有限公司")
_citys["保险公司－财产险"].push("阳光农业相互保险公司")
_citys["保险公司－财产险"].push("爱和谊日生同和财产保险（中国）")
_citys["保险公司－财产险"].push("国元农业保险股份有限公司")
_citys["保险公司－财产险"].push("鼎和财产保险股份有限公司")
_citys["保险公司－财产险"].push("中煤财产保险股份有限公司")
_citys["保险公司－财产险"].push("国泰财产保险有限责任公司")
_citys["保险公司－财产险"].push("英大泰和财产保险股份有限公司")
_citys["保险公司－财产险"].push("紫金财产保险股份有限公司")
_citys["保险公司－财产险"].push("日本兴亚财产保险（中国）有限责任公司")
_citys["保险公司－财产险"].push("浙商财产保险股份有限公司")
_citys["保险公司－财产险"].push("信达财产保险股份有限公司")
_citys["保险公司－财产险"].push("富德财产保险股份有限公司")
_citys["保险公司－财产险"].push("鑫安汽车保险股份有限公司")
_citys["保险公司－财产险"].push("北部湾财产保险股份有限公司")
_citys["保险公司－财产险"].push("众安在线财产保险股份有限公司")
_citys["保险公司－财产险"].push("华海财产保险股份有限公司")
_citys["保险公司－财产险"].push("燕赵财产保险股份有限公司")
_citys["保险公司－财产险"].push("太平财产保险有限公司")
_citys["保险公司－财产险"].push("民安财产保险有限公司")
_citys["保险公司－财产险"].push("美亚财产保险有限公司")
_citys["保险公司－财产险"].push("东京海上日动火灾保险（中国）有限公司")
_citys["保险公司－财产险"].push("安盛保险有限公司")
_citys["保险公司－财产险"].push("瑞再企商保险有限公司")
_citys["保险公司－财产险"].push("丘博保险（中国）有限公司")
_citys["保险公司－财产险"].push("三井住友海上火灾保险（中国）有限公司")
_citys["保险公司－财产险"].push("三星财产保险（中国）有限公司")
_citys["保险公司－财产险"].push("中银保险有限公司")
_citys["保险公司－财产险"].push("都邦财产保险股份有限公司")
_citys["保险公司－财产险"].push("渤海财产保险股份有限公司")
_citys["保险公司－财产险"].push("华农财产保险股份有限公司")
_citys["保险公司－财产险"].push("苏黎世财产保险（中国）有限公司")
_citys["保险公司－财产险"].push("中国人寿财产保险股份有限公司")
_citys["保险公司－财产险"].push("安诚财产保险股份有限公司")
_citys["保险公司－财产险"].push("现代财产保险（中国）有限公司")
_citys["保险公司－财产险"].push("长安责任保险股份有限公司")
_citys["保险公司－财产险"].push("劳合社保险（中国）有限公司")
_citys["保险公司－财产险"].push("中意财产保险有限公司")
_citys["保险公司－财产险"].push("有限公司乐爱金财产保险（中国）有限公司")
_citys["保险公司－财产险"].push("富邦财产保险有限公司")
_citys["保险公司－财产险"].push("信利保险（中国）有限公司")
_citys["保险公司－财产险"].push("泰山财产保险股份有限公司")
_citys["保险公司－财产险"].push("锦泰财产保险股份有限公司")
_citys["保险公司－财产险"].push("众诚汽车保险股份有限公司")
_citys["保险公司－财产险"].push("华泰财产保险有限公司")
_citys["保险公司－财产险"].push("长江财产保险股份有限公司")
_citys["保险公司－财产险"].push("诚泰财产保险股份有限公司")
_citys["保险公司－财产险"].push("安邦财产保险股份有限公司")
_citys["保险公司－财产险"].push("恒邦财产保险股份有限公司")
_citys["保险公司－财产险"].push("合众财产保险股份有限公司")
_citys["保险公司－财产险"].push("中路财产保险股份有限公司")
_citys["保险公司－财产险"].push("中原农业保险股份有限公司")
_citys["保险公司－财产险"].push("中国铁路财产保险自保有限公司")

_citys["再保险公司"] = []
_citys["再保险公司"].push("中国财产再保险有限责任公司")
_citys["再保险公司"].push("中国人寿再保险有限责任公司")
_citys["再保险公司"].push("瑞士再保险股份有限公司北京分公司")
_citys["再保险公司"].push("慕尼黑再保险公司北京分公司")
_citys["再保险公司"].push("德国通用再保险股份公司上海分公司")
_citys["再保险公司"].push("法国再保险公司北京分公司")
_citys["再保险公司"].push("汉诺威再保险股份公司上海分公司")
_citys["再保险公司"].push("太平再保险有限公司")
_citys["再保险公司"].push("RGA美国再保险公司上海分公司")

_citys["保险资产管理公司"] = []
_citys["保险资产管理公司"].push("中国人保资产管理股份有限公司")
_citys["保险资产管理公司"].push("中国人寿资产管理有限公司")
_citys["保险资产管理公司"].push("华泰资产管理有限公司")
_citys["保险资产管理公司"].push("平安资产管理有限责任公司")
_citys["保险资产管理公司"].push("中再资产管理股份有限公司")
_citys["保险资产管理公司"].push("泰康资产管理有限责任公司")
_citys["保险资产管理公司"].push("太平洋资产管理有限责任公司")
_citys["保险资产管理公司"].push("太平资产管理有限公司")
_citys["保险资产管理公司"].push("新华资产管理股份有限公司")
_citys["保险资产管理公司"].push("安邦资产管理有限责任公司")
_citys["保险资产管理公司"].push("华夏久盈资产管理有限责任公司	")
_citys["保险资产管理公司"].push("生命保险资产管理有限公司")
_citys["保险资产管理公司"].push("光大永明资产管理股份有限公司")
_citys["保险资产管理公司"].push("合众资产管理股份有限公司")
_citys["保险资产管理公司"].push("民生通惠资产管理有限公司")
_citys["保险资产管理公司"].push("阳光资产管理股份有限公司")
_citys["保险资产管理公司"].push("中英益利资产管理股份有限公司")
_citys["保险资产管理公司"].push("中意资产管理有限责任公司")
_citys["保险资产管理公司"].push("华安财保资产管理有限责任公司")
_citys["保险资产管理公司"].push("长城财富资产管理股份有限公司")
_citys["保险资产管理公司"].push("英大保险资产管理有限公司")



_QUESTION = [
	{
		id: 1,
		question: "这是题目1",
		answers: [
			"A",
			"B",
			"C",
			"D"
		],
		banner: "http://m.giccoo.com/qa/img/banner.jpg",
		link: "http://www.baidu.com"
	},
	{
		id: 2,
		question: "这是题目2",
		answers: [
			"a",
			"b",
			"c",
			"d"
		],
		banner: "http://m.giccoo.com/qa/img/banner.jpg",
		link: "http://www.baidu.com"
	},
	{
		id: 3,
		question: "这是题目3",
		answers: [
			"a",
			"b",
			"c",
			"d"
		],
		banner: "http://m.giccoo.com/qa/img/banner.jpg",
		link: "http://www.baidu.com"
	},
	{
		id: 4,
		question: "这是题目4",
		answers: [
			"a",
			"b",
			"c",
			"d"
		],
		banner: "http://m.giccoo.com/qa/img/banner.jpg",
		link: "http://www.baidu.com"
	},
	{
		id: 5,
		question: "这是题目5",
		answers: [
			"a",
			"b",
			"c",
			"d"
		],
		banner: "http://m.giccoo.com/qa/img/banner.jpg",
		link: "http://www.baidu.com"
	},
	{
		id: 6,
		question: "这是题目6",
		answers: [
			"a",
			"b",
			"c",
			"d"
		],
		banner: "http://m.giccoo.com/qa/img/banner.jpg",
		link: "http://www.baidu.com"
	},
	{
		id: 7,
		question: "这是题目7",
		answers: [
			"a",
			"b",
			"c",
			"d"
		],
		banner: "http://m.giccoo.com/qa/img/banner.jpg",
		link: "http://www.baidu.com"
	},
	{
		id: 8,
		question: "这是题目8",
		answers: [
			"a",
			"b",
			"c",
			"d"
		],
		banner: "http://m.giccoo.com/qa/img/banner.jpg",
		link: "http://www.baidu.com"
	},
	{
		id: 9,
		question: "这是题目9",
		answers: [
			"a",
			"b",
			"c",
			"d"
		],
		banner: "http://m.giccoo.com/qa/img/banner.jpg",
		link: "http://www.baidu.com"
	},
	{
		id: 10,
		question: "这是题目10",
		answers: [
			"a",
			"b",
			"c",
			"d"
		],
		banner: "http://m.giccoo.com/qa/img/banner.jpg",
		link: "http://www.baidu.com"
	}
]
_QUESTION_COMPANY = [
	{
		id: 1,
		question: "这是保险从业题目1",
		answers: [
			"A",
			"B",
			"C",
			"D"
		],
		banner: "http://m.giccoo.com/qa/img/banner.jpg",
		link: "http://www.baidu.com"
	},
	{
		id: 2,
		question: "这是保险从业题目2",
		answers: [
			"a",
			"b",
			"c",
			"d"
		],
		banner: "http://m.giccoo.com/qa/img/banner.jpg",
		link: "http://www.baidu.com"
	},
	{
		id: 3,
		question: "这是保险从业题目3",
		answers: [
			"a",
			"b",
			"c",
			"d"
		],
		banner: "http://m.giccoo.com/qa/img/banner.jpg",
		link: "http://www.baidu.com"
	},
	{
		id: 4,
		question: "这是保险从业题目4",
		answers: [
			"a",
			"b",
			"c",
			"d"
		],
		banner: "http://m.giccoo.com/qa/img/banner.jpg",
		link: "http://www.baidu.com"
	},
	{
		id: 5,
		question: "这是保险从业题目5",
		answers: [
			"a",
			"b",
			"c",
			"d"
		],
		banner: "http://m.giccoo.com/qa/img/banner.jpg",
		link: "http://www.baidu.com"
	},
	{
		id: 6,
		question: "这是保险从业题目6",
		answers: [
			"a",
			"b",
			"c",
			"d"
		],
		banner: "http://m.giccoo.com/qa/img/banner.jpg",
		link: "http://www.baidu.com"
	},
	{
		id: 7,
		question: "这是保险从业题目7",
		answers: [
			"a",
			"b",
			"c",
			"d"
		],
		banner: "http://m.giccoo.com/qa/img/banner.jpg",
		link: "http://www.baidu.com"
	},
	{
		id: 8,
		question: "这是保险从业题目8",
		answers: [
			"a",
			"b",
			"c",
			"d"
		],
		banner: "http://m.giccoo.com/qa/img/banner.jpg",
		link: "http://www.baidu.com"
	},
	{
		id: 9,
		question: "这是保险从业题目9",
		answers: [
			"a",
			"b",
			"c",
			"d"
		],
		banner: "http://m.giccoo.com/qa/img/banner.jpg",
		link: "http://www.baidu.com"
	},
	{
		id: 10,
		question: "这是保险从业题目10",
		answers: [
			"a",
			"b",
			"c",
			"d"
		],
		banner: "http://m.giccoo.com/qa/img/banner.jpg",
		link: "http://www.baidu.com"
	}
]
company = null

loadStart = ->
	count = $("[data-src]").length
	now = 0
	ep = $("#loading-text")

	$("[data-src]").each ->
		# $(this).attr("src",$(this).attr("data-layzr"))
		img = new Image()
		img.onload = ->
			now++
			ep.text parseInt now/count*100
			loadEnd() if now >= count
		img.src = $(this).attr("data-src")
		$(this).after(img)
		$(this).remove()
loadEnd = ->
	riot.mount("#select-company","select-company")
	riot.mount("#qa","qa")
	$(".loading").addClass("fadeOut animated")
	setTimeout ->
		$(".loading").remove()
	,520

window.onload = ->
	# loadStart()
	project = "qa" if not project?
	if openid == ""
		window.location.href = "https://open.weixin.qq.com/connect/oauth2/authorize?appid=wxb3dd8b8d67e940c4&redirect_uri={url}&response_type=code&scope=snsapi_base&state=123#wechat_redirect".replace("{url}",encodeURIComponent("http://i.giccoo.com/#{project}/"))
		return false


	riot.mount("#pages","pages")

	MK = $("body").width()/$("body").height()
	if $("body").height() <= 460 or MK > 0.65
		$("body").addClass "iphone4"

	$(".btn-join").click ->
		$(".page.info-page").removeClass "on"
		$(".page.note-page").addClass "on"

	$(".btn-company").click ->
		# $(".page.note-page").removeClass "on"
		return showFocus() if subscribe is 0
		$(".pop.select-company").addClass "on"
	$(".btn-personal").click ->
		return showFocus() if subscribe is 0
		$(".page.note-page").removeClass "on"
		$(".page.question-page").addClass "on"

	loadWechatConfig()
	wx.ready ->
		shareContent =
			title: SHARETITLE
			desc: SHAREDESC
			link: SHARELINK
			imgUrl: "http://disk.giccoo.com/projects/qa/img/share.jpg"
			success: ->
				# alert "success"
			cancel: ->
				# alert "cancel"
		wx.onMenuShareTimeline shareContent
		wx.onMenuShareAppMessage shareContent
		wx.onMenuShareQQ shareContent
		wx.onMenuShareWeibo shareContent

loadWechatConfig = ->
	url = encodeURIComponent window.location.href.split("#")[0]
	hm = document.createElement('script')
	hm.src = "http://api.giccoo.com/config?url="+url
	s = document.getElementsByTagName('script')[0]
	s.parentNode.insertBefore hm, s
	return

UpdateShare = (text)->
	TimelineShareContent =
		title: text
		desc: SHAREDESC
		link: SHARELINK
		imgUrl: "http://disk.giccoo.com/projects/qa/img/share.jpg"
		success: ->
			# alert "success"
		cancel: ->
			# alert "cancel"
	wx.onMenuShareTimeline TimelineShareContent
	wx.onMenuShareAppMessage TimelineShareContent
	wx.onMenuShareQQ TimelineShareContent
	wx.onMenuShareWeibo TimelineShareContent

showFocus = ->
	$(".pop.focus-page").addClass("on")
hideFocus = ->
	$(".pop.focus-page").removeClass("on")


CompanyPage = (name)->
	company = name
	$(".page.note-page").removeClass "on"
	$(".page.question-page").addClass "on"


POST = (answers,callback)->
	# console.log answers
	data = {openid: openid,answer: answers.join(",")}
	data.company = company if company?
	# $.post "http://i.giccoo.com/qa/to/answer/",data, (msg)->
	$.post POSTurl,data, (msg)->
		if msg.recode is 200
			SendNote("提交成功")
			setTimeout ->
				Done(msg)
			,3000
		else
			SendNote(msg.reason)

Done = (msg)->
	fen = msg.info.fen
	if msg.info.fen > 20
		fen = fen-10+parseInt(Math.random()*10)
	else
		fen = fen
	UpdateShare("恭喜你!保险知识竞赛正确率超过了 #{fen}% 的网友.")
	$(".page.finished-page #nums").text(fen)
	$(".page").removeClass("on")
	$(".page.finished-page").addClass("on")

showShare = ->
	$(".share-box").addClass("on")
hideShare = ->
	$(".share-box").removeClass("on")


SendNote = (msg,time = 3000)->
	$("body").append("<note title='"+msg+"' time='#{time}'></note>")
	riot.mount("note")