# @codekit-prepend "coffee/css3Prefix"
# @codekit-prepend "coffee/plus"
# @codekit-prepend "../../libs/coffee/requestanimation"
# images = "http://disk.giccoo.com/projects/huaweiG7/"
images = ""
imageList = [
	# "http://disk.giccoo.com/projects/libs/img/wechat.png"
	"img/pages-contactus-bg.png"
	"img/bg.jpg"
	"img/bottle-award-shadow.png"
	"img/bottle-award-white.png"
	"img/bottle-award.png"
	"img/bottle-brand-white.png"
	"img/bottle-brand.png"
	"img/bottle-contactus-shadow.png"
	"img/bottle-contactus-white.png"
	"img/bottle-contactus.png"
	"img/bottle-lighter-fire.png"
	"img/bottle-lighter.png"
	"img/bottle-logo-full-white-1.png"
	"img/bottle-logo-full-white-2.png"
	"img/bottle-logo-full.png"
	"img/bottle-logo-next-white-1.png"
	"img/bottle-logo-next-white-2.png"
	"img/bottle-logo-next-white-3.png"
	"img/bottle-logo-next-white-4.png"
	"img/bottle-logo-next-white.png"
	"img/bottle-logo-next.png"
	"img/bottle-logo-white.png"
	"img/bottle-logo.png"
	"img/bottle-media-shadow.png"
	"img/bottle-media-white.png"
	"img/bottle-media.png"
	"img/bottle-strategy-shadow.png"
	"img/bottle-strategy-white.png"
	"img/bottle-strategy.png"
	"img/bottle-technology-shadow.png"
	"img/bottle-technology-white.png"
	"img/bottle-technology.png"
	"img/bottom-bottle.png"
	"img/homepage-bubble.png"
	"img/icon-brand-1.png"
	"img/icon-brand-10.png"
	"img/icon-brand-11.png"
	"img/icon-brand-12.png"
	"img/icon-brand-2.png"
	"img/icon-brand-3.png"
	"img/icon-brand-4.png"
	"img/icon-brand-5.png"
	"img/icon-brand-6.png"
	"img/icon-brand-7.png"
	"img/icon-brand-8.png"
	"img/icon-brand-9.png"
	"img/icon-logo-bmw.png"
	"img/magn.png"
	"img/middle-tower.png"
	"img/pages-award-bg.png"
	"img/pages-award-icon-1.png"
	"img/pages-award-icon-2.png"
	"img/pages-award-icon-3.png"
	"img/pages-award-icon-4.png"
	"img/pages-award-icon-5.png"
	"img/pages-award-icon-6.png"
	"img/pages-award-icon-7.png"
	"img/pages-award-other-1.png"
	"img/pages-award-other-2.png"
	"img/pages-brand-bg.jpg"
	"img/pages-brand-line.png"
	"img/pages-contactus-drops.png"
	"img/pages-contactus-offon.png"
	"img/pages-contactus-pointer.png"
	"img/pages-contactus-qrcode.png"
	"img/pages-contactus-text.png"
	"img/pages-logo-bg-end.jpg"
	"img/pages-logo-bg-start.jpg"
	"img/pages-logo-text.png"
	"img/pages-media-bg.png"
	"img/pages-media-bottle-1.png"
	"img/pages-media-bottle-2.png"
	"img/pages-media-bottle-3.png"
	"img/pages-media-bottle-4.png"
	"img/pages-media-bottle-5.png"
	"img/pages-media-bottle-6.png"
	"img/pages-media-bottle-7.png"
	"img/pages-media-icon-1.png"
	"img/pages-media-icon-10.png"
	"img/pages-media-icon-11.png"
	"img/pages-media-icon-12.png"
	"img/pages-media-icon-2.png"
	"img/pages-media-icon-3.png"
	"img/pages-media-icon-4.png"
	"img/pages-media-icon-5.png"
	"img/pages-media-icon-6.png"
	"img/pages-media-icon-7.png"
	"img/pages-media-icon-8.png"
	"img/pages-media-icon-9.png"
	"img/pages-strategy-arrow-yellow.png"
	"img/pages-strategy-arrow.png"
	"img/pages-strategy-box.png"
	"img/pages-strategy-canvas-1.png"
	"img/pages-strategy-canvas-2.png"
	"img/pages-strategy-icloud-1.png"
	"img/pages-strategy-icloud-2.png"
	"img/pages-strategy-icloud-3.png"
	"img/pages-strategy-icons.png"
	"img/pages-strategy-light-all-1.png"
	"img/pages-strategy-light-all-2.png"
	"img/pages-strategy-light-all-3.png"
	"img/pages-strategy-light-all-4.png"
	"img/pages-strategy-light-all.png"
	"img/pages-strategy-light-blue.png"
	"img/pages-strategy-light-red.png"
	"img/pages-strategy-lighter.png"
	"img/pages-strategy-line-1.png"
	"img/pages-strategy-line-2.png"
	"img/pages-strategy-logo.png"
	"img/pages-strategy-m-bottom.png"
	"img/pages-strategy-m-top.png"
	"img/pages-strategy-parts-red.png"
	"img/pages-strategy-parts-roulette.png"
	"img/pages-strategy-parts-yellow.png"
	"img/pages-strategy-people-1.png"
	"img/pages-strategy-people-2.png"
	"img/pages-strategy-screw.png"
	"img/pages-strategy-switch.png"
	"img/pages-technology-bottom.png"
	"img/pages-technology-top.png"
	"img/right-tower-sound.png"
	"img/right-tower-timer.png"
	"img/search-tower.png"
	"img/time-tower.png"


	"img/animate/bottle-award/award.png"
	"img/animate/bottle-brand/brand.png"
	"img/animate/bottle-contactus/contactus.png"
	"img/animate/bottle-logo/logo.png"
	"img/animate/bottle-media/media.png"
	"img/animate/bottle-strategy/strategy.png"
	"img/animate/bottle-technology/technology.png"
	"img/animate/bottle-technology/logo.png"
	# "img/animate/brandbg/brandbg.png"
	"img/animate/brands/brand-1.png"
	"img/animate/brands/brand-2.png"
	"img/animate/strategy-icons/p1.png"
	"img/animate/strategy-icons/p2.png"
	"img/animate/strategy-icons/strategy.png"


	"img/technology/b-1.png"
	"img/technology/b-2.png"
	"img/technology/b-3.png"
	"img/technology/b-4.png"
	"img/technology/b-5.png"
	"img/technology/box.png"
	"img/technology/bt-1.png"
	"img/technology/bt-2.png"
	"img/technology/gear-1.png"
	"img/technology/gear-2.png"
	"img/technology/gear-3.png"
	"img/technology/p-1.png"
	"img/technology/hand.png"
	"img/technology/i-1.png"
	"img/technology/i-2.png"
	"img/technology/i-3.png"
	"img/technology/i-4.png"
	"img/technology/i-5.png"
	"img/technology/l-1.png"
	"img/technology/l-2.png"
	"img/technology/l-3.png"
	"img/technology/l-4.png"
	"img/technology/l-5.png"
	"img/technology/p-0.png"
	"img/technology/p-2.png"
	"img/technology/p-3.png"
	"img/technology/p-4.png"
	"img/technology/p-5.png"
	"img/technology/pages-technology-top.png"
	"img/technology/switch.png"
	"img/technology/t-1.png"
	"img/technology/t-2.png"
	"img/technology/t-3.png"
	"img/technology/t-4.png"
	"img/technology/t-5.png"
]
imgs = []
# riot.mount("*")
page = ["page-brand"]
pages = [".pages-brand"]
opened = false
global = {}

window.onload = ->
	riot.mount("*")
	$(".bottle-logo-next").css {
		bottom: 164 - $("body").height() * 0.13 - 18
	}
	$(".pages-award .icon").on "click", openAward
	$(".pages-media .icon").on "click", openMedia
	$(".pages-brand .item").on "click", openBrand
	$(".firstPage .content").on "click", init

init = ->
	$(".firstPage").addClass "on"
	setTimeout ->
		loadAllImage()
	,1500

loadAllImage = ->
	max = imageList.length
	for image in imageList
		img = new Image()
		img.onload = ->
			max--
			loadComper parseInt (imageList.length-max)/imageList.length*100
			loadFinished() if max <= 0
		img.src = image
		imgs.push(img)
loadComper = (m)->
	$("#loading-text").text m

tags = null
loadFinished = ->
	tags = riot.mount("div#main","main")
	setTimeout ->
		$(".firstPage").addClass "fadeOut animated"
		setTimeout ->
			$(".firstPage").remove()
		,500
	,1000

openBottle = (evt)->
	return false if opened 
	console.log evt
	name = $(evt).attr("page-name")
	$(evt).next().addClass "on"
	$(".bottle-"+name).addClass "Mybottle"
	$(".homepage").addClass "page-"+name
	$(".pages-"+name).show()
	setTimeout ->
		$(".pages-"+name).addClass "thispage"
	,1
	# console.log name

	opened = true

backBottle = (name)->
	$(".homepage").removeClass "page-"+name
	$(".bottle-"+name+" .white").removeClass "on"
	$(".pages-"+name).removeClass "thispage"
	$(".bottle-"+name).removeClass "Mybottle"
	setTimeout ->
		$(".pages-"+name).hide()
	,2000
	opened = false

openBottleMain = (evt)->
	return false if opened 
	name = $(evt).attr("page-name")
	$(evt).next().addClass "on"
	$(".bottle-"+name).addClass "Mybottle"
	$(".main").addClass "page-"+name
	$(".pages-"+name).show()
	$(".pages-"+name).addClass "thispage"
	# global["bottle"+name].replay("replay") if global? && global["bottle"+name]?
	opened = true
	$("#bottle"+name+" .gif").removeClass("normal replay stop").addClass("replay")
	brandShow() if name is "brand"

backBottleMain = (name)->
	$(".main").removeClass "page-"+name
	$(".bottle-"+name+" .white").removeClass "on"
	$(".pages-"+name).removeClass "thispage"
	$(".bottle-"+name).removeClass "Mybottle"
	opened = false
	# global["bottle"+name].replay("normal") if global? && global["bottle"+name]?
	$("#bottle"+name+" .gif").removeClass("normal replay stop").addClass("normal")
	clearNone()
awardList = [
	{}
]  
openBrand = (evt)->
	evt.stopPropagation()
	e = $(evt.target)

	console.log e.attr "rel"
openAward = (evt)->
	evt.stopPropagation()
	e = $(evt.target).parents(".icon")

	console.log e.attr "rel"
openMedia = (evt)->
	evt.stopPropagation()
	e = $(evt.target).parents(".icon")

	console.log e.attr "rel"

clearNone = ->
	setTimeout ->
		$(".pages-brand .brands-item").html("")
	,500

brandShow = ->
	console.log global.brandbg?,global.brand?
	# global.brandbg.replay("normal") if global? and global.brandbg?
	# global.brand.replay("normal") if global? and global.brand?
	$(".pages-brand .content").hide()
	setTimeout ->
		# global.brandbg.replay("replay") if global? and global.brandbg?
		# global.brand.replay("replay") if global? and global.brand?
		$(".pages-brand .content").show()
		$(".pages-brand .brands-item").html("<div class='brand-item brand-item-1' ></div><div class='brand-item brand-item-2' ></div>")
	,1700
	# $("#brandbg")[0].addEventListener ANIMATION_END_NAME, (evt)->
	# 	setTimeout ->
	# 		$(".pages-brand .brands-item").html("<div class='brand-item brand-item-1' ></div><div class='brand-item brand-item-2' ></div>")
	# 	,300


