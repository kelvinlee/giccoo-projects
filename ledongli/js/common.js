"use strict";!function(){var e=window.ldl={userData:{},version:"0.7.15"};(function(e,t){var n=this.os={},r=this.browser={},i=e.match(/Web[kK]it[\/]{0,1}([\d.]+)/),o=e.match(/(Android);?[\s\/]+([\d.]+)?/),a=!!e.match(/\(Macintosh\; Intel /),s=e.match(/(iPad).*OS\s([\d_]+)/),c=e.match(/(iPod)(.*OS\s([\d_]+))?/),u=!s&&e.match(/(iPhone\sOS)\s([\d_]+)/),p=e.match(/(webOS|hpwOS)[\s\/]([\d.]+)/),d=/Win\d{2}|Windows/.test(t),l=e.match(/Windows Phone ([\d.]+)/),f=p&&e.match(/TouchPad/),h=e.match(/Kindle\/([\d.]+)/),g=e.match(/Silk\/([\d._]+)/),A=e.match(/(BlackBerry).*Version\/([\d.]+)/),m=e.match(/(BB10).*Version\/([\d.]+)/),v=e.match(/(RIM\sTablet\sOS)\s([\d.]+)/),w=e.match(/PlayBook/),b=e.match(/Chrome\/([\d.]+)/)||e.match(/CriOS\/([\d.]+)/),D=e.match(/Firefox\/([\d.]+)/),S=e.match(/\((?:Mobile|Tablet); rv:([\d.]+)\).*Firefox\/[\d.]+/),y=e.match(/MSIE\s([\d.]+)/)||e.match(/Trident\/[\d](?=[^\?]+).*rv:([0-9.].)/),k=!b&&e.match(/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/),x=k||e.match(/Version\/([\d.]+)([^S](Safari)|[^M]*(Mobile)[^S]*(Safari))/);(r.webkit=!!i)&&(r.version=i[1]),o&&(n.android=!0,n.version=o[2]),u&&!c&&(n.ios=n.iphone=!0,n.version=u[2].replace(/_/g,".")),s&&(n.ios=n.ipad=!0,n.version=s[2].replace(/_/g,".")),c&&(n.ios=n.ipod=!0,n.version=c[3]?c[3].replace(/_/g,"."):null),l&&(n.wp=!0,n.version=l[1]),p&&(n.webos=!0,n.version=p[2]),f&&(n.touchpad=!0),A&&(n.blackberry=!0,n.version=A[2]),m&&(n.bb10=!0,n.version=m[2]),v&&(n.rimtabletos=!0,n.version=v[2]),w&&(r.playbook=!0),h&&(n.kindle=!0,n.version=h[1]),g&&(r.silk=!0,r.version=g[1]),!g&&n.android&&e.match(/Kindle Fire/)&&(r.silk=!0),b&&(r.chrome=!0,r.version=b[1]),D&&(r.firefox=!0,r.version=D[1]),S&&(n.firefoxos=!0,n.version=S[1]),y&&(r.ie=!0,r.version=y[1]),x&&(a||n.ios||d)&&(r.safari=!0,n.ios||(r.version=x[1])),k&&(r.webview=!0),n.tablet=!!(s||w||o&&!e.match(/Mobile/)||D&&e.match(/Tablet/)||y&&!e.match(/Phone/)&&e.match(/Touch/)),n.phone=!(n.tablet||n.ipod||!(o||u||p||A||m||b&&e.match(/Android/)||b&&e.match(/CriOS\/([\d.]+)/)||D&&e.match(/Mobile/)||y&&e.match(/Touch/))),this.isIos=this.os.ios,this.isAndroid=this.os.android,this.isWeixin="micromessenger"==e.toLowerCase().match(/MicroMessenger/i);var B=e.match(/(?:(cn\.ledongli\.Runner)|(cc\.fenzi\.xiaoqin)|(cn\.ledongli\.ldl))\/([0-9_.]+)$/i);B?(this.isApp=!0,this.app={},this.app.name=B[0].match(/runner/i)?"runner":"ledongli",this.app.version=B[4]):(B=e.match(/(?:(cn\.ledongli\.spt)|(cn\.ledongli\.sps)|(cn\.ledongli\.Slimfastteacher)|(cn\.ledongli\.Slimfaststudent))\/([0-9_.]+)$/i),B&&(this.isApp=!0,this.app={},this.app.name=B[0].match(/Slimfastteacher|spt/i)?"s_teacher":"s_student",this.app.version=B[5]))}).call(e,navigator.userAgent,navigator.platform),function(){if(!window.$&&!window.$.Deferred)throw new Error("Need zepto with Deferred!!!")}(),e.isInApp=function(){return e.app?$.Deferred().resolve():e.loadAppJs()},function(){var t={code:function(){var t=e.getUrlObj(),n=t.search.code;return n?e.getData("//walk.ledongli.cn:8090/v2/rest/users/accesstokenwechatweb",{code:n}).then(function(e){return 0==e.errorCode?$.Deferred().resolve(e):$.Deferred().reject("code无效")}):$.Deferred().reject("缺少code")},refreshToken:function(t){return t?e.getData("//walk.ledongli.cn:8090/v2/rest/users/refreshtokenwechatweb",{refresh_token:t}).then(function(t){return 0==t.errorCode?$.Deferred().resolve(t):(e.isSupportStorage&&sessionStorage._userData&&delete sessionStorage._userData,$.Deferred().reject("请重新授权登录"))}):$.Deferred().reject("refresh_token无效")}},n=function(e,n){return t[e]?t[e](n):$.Deferred.reject("没找到这种授权方式:"+e)},r=function(t,n){e.isSupportStorage&&n&&(sessionStorage[t]=JSON.stringify(n))};e.getUserDataInWeixin=function(){var t;return e.isSupportStorage&&sessionStorage._userData&&(t=JSON.parse(sessionStorage._userData)),t&&"wechat"==t.src?($.extend(e.userData,t),t.expires>+new Date?$.Deferred().resolve():n("refreshToken",t.refresh_token).done(function(t){e.userData.access_token=t.ret.access_token,e.userData.refresh_token=t.ret.refresh_token,e.userData.openid=t.ret.openid,e.userData.expires=1e3*t.ret.expires_in+ +new Date,r("_userData",e.userData)})):(e.isSupportStorage&&sessionStorage._userData&&delete sessionStorage._userData,n("code").done(function(t){0===t.errorCode&&(e.userData.access_token=t.ret.access_token,e.userData.refresh_token=t.ret.refresh_token,e.userData.openid=t.ret.openid,e.userData.uid=t.ret.uid,e.userData.unionid=t.ret.unionid,e.userData.expires=1e3*t.ret.expires_in+ +new Date,e.userData.src="wechat",r("_userData",e.userData))}))}}(),e.weixin=function(){var t,n=function(n,r,i,o){if(t)return t.promise();t=$.Deferred();var a=document.createElement("script"),s="//common.ledongli.cn/common_service/wechat/js_sign";return"mp"==i&&(s="//sprogram.ledongli.cn/v1/rest/recruit/wechat_jsapi_ticket"),a.src="//res.wx.qq.com/open/js/jweixin-1.0.0.js",a.onload=function(){e.getData(s,{url:encodeURIComponent(location.href),app:r||"ledongli"}).done(function(e){wx.config({debug:o,appId:n||"wx13e719bc136549a8",timestamp:e.ret.timestamp,nonceStr:e.ret.nonceStr,signature:e.ret.signature,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareWeibo","openLocation","getLocation","chooseWXPay"]}),t.resolve()}).fail(t.reject)},document.body.appendChild(a),t.promise()},r=function(e,r){return t?void t.done(e):n(r.appId,r.appName,r.wxType,r.debug).done(function(){wx.ready(e)})};return{share:function(e){r(function(){wx.onMenuShareAppMessage(e),wx.onMenuShareTimeline(e),wx.onMenuShareQQ(e),wx.onMenuShareWeibo(e)},e)},getLocation:function(e){r(function(){wx.getLocation({type:e.type||"wgs84",success:e.success,fail:e.fail,complete:e.complete,cancel:e.cancel})},e)},pay:function(e){r(function(){wx.chooseWXPay({timestamp:e.timestamp,nonceStr:e.nonceStr,"package":e["package"],signType:e.signType||"SHA1",paySign:e.paySign,success:e.success,fail:e.fail,complete:e.complete,cancel:e.cancel})},e)}}}(),e.loadAppJs=function t(){function n(n){e.isApp=!0,n.init(function(){}),r.forEach(function(r){e.app[r]=function(r){return function i(o){if(!t.deferred)return t().then(function(){return i()});var a=$.Deferred(),s=setTimeout(function(){a.reject(r+" 执行失败")},5e3),c=o;try{var u=JSON.parse(o);u._callback&&u.params&&(c=JSON.stringify(u.params))}catch(p){}return n.callHandler(r,c,function(t){clearTimeout(s),a.resolve(t);try{var n=JSON.parse(o);if(n._callback){var r=n._callback.split(".").pop();"function"==typeof e.callbacks[r]?e.callbacks[r](t):console.error("callbacks "+r+"不存在")}}catch(i){console.error("callbacks 解析失败")}}),a.promise()}}(r)}),i.resolve("ios")}if(t.deferred)return t.deferred.promise();var r="login getAppInfo getUserId getUserInfo getWebCondition getActivitywithData setUserGoalWithData getDailyStatsWithData openURLWithData getCurrentLocation setWebViewShare openWithWebView launchWeChatPay updateShareModel chooseImage tapUserinfo tapShare".split(" "),i=$.Deferred();return setTimeout(function(){i.reject("app接口检测超时")},5e3),e.app=e.app||{},t.deferred=i,e.app.callNativeWithCallback=function(t){var n="_"+Math.random().toString(36).slice(2),r=JSON.stringify({params:t.params,_callback:"ldl.callbacks."+n});e.callbacks=e.callbacks||{},e.callbacks[n]=function(r){t.callback(r),delete e.callbacks[n]},e.app[t.action](r)},e.isIos?window.WebViewJavascriptBridge?n(WebViewJavascriptBridge):document.addEventListener("WebViewJavascriptBridgeReady",function(){n(WebViewJavascriptBridge)},!1):e.isAndroid&&("undefined"!=typeof web&&"function"==typeof web.getUserInfo||e.isApp)&&(e.isApp=!0,r.forEach(function(t){e.app[t]=function(e){return function(t){var n="undefined"!=typeof t?web[e](t):web[e]();return $.Deferred().resolve(n)}}(t)}),i.resolve("android")),i.promise()},e.getUserDataInapp=function(){return e.loadAppJs().then(function(){return e.app.getUserInfo()},function(){return $.Deferred().reject("不在app里")}).then(function(t){var n=$.Deferred();try{var r=JSON.parse(t);e.userData=r,n.resolve(r)}catch(i){n.reject("获取用户信息失败")}return n.promise()})},e.handleErrorCode=function(t,n){var r={"-10001":"授权失败","-10002":"微信授权失败","-10003":"上传活动checksum失败","-10004":"上传活动失败","-10005":"上传活动图片失败","-10006":"下载用户活动时获取pb文件失败","-10009":"发送手机验证码失败","-20001":"错误的地理位置信息","-20002":"获取天气失败","-40001":"用户已经在一个跑团","-40002":"入团密码错误","-40003":"用户不在团内","-40004":"未登录或非团长","-40005":"上传OSS失败","-40006":"验证码过期","-40007":"验证码无效","-40008":"错误的uid","-40009":"不能修改团长的职称","-40010":"修改职称无效","-50004":"人数超出限制"};n.codeMap&&$.extend(r,n.codeMap),n&&n.ecHandler&&"function"==typeof n.ecHandler[t]?n.ecHandler[t]():n&&"function"==typeof n.handler?n.handler(r[t]):e.gModalTip.show('<span style="white-space:nowrap;">'+(r[t]||"出错了")+"</span>",n&&n.holdTime||3e3)},e.getUserData=function(){return e.isWeixin?e.getUserDataInWeixin():e.getUserDataInapp()},e.getUserDataNew=function(){var t=e.getUrlObj().search;return t.uid&&t.pc?$.Deferred().resolve({uid:t.uid,pc:t.pc,src:"url"}):e.getUserDataInapp()},e.shareBy=function(){var t=function(e,t){return"function"==typeof n[e]&&n[e](t)},n={app:function(t){"ledongli"==e.app.name?e.app.setWebViewShare(JSON.stringify(t)):"runner"==e.app.name&&e.app.updateShareModel(JSON.stringify(t))},weixin:function(t){e.weixin.share(t)}};return t}(),function(){var t={on:function(e,t){return"function"==typeof t&&(this._events||(this._events={}),this._events[e]||(this._events[e]=[]),this._events[e].push(t)),this},one:function(e,t){if("function"==typeof t){var n=this,r=function(){t(),n.off(e,r)};this.on(e,r)}return this},off:function(e,t){if(!this._events||!this._events[e])return this;for(var n=0;n<this._events[e].length;n++)this._events[e][n]===t&&delete this._events[e][n];return this},trigger:function(e){if(!this._events||!this._events[e])return this;for(var t=[].slice.call(arguments,1),n=0;n<this._events[e].length;n++)"function"==typeof this._events[e][n]&&this._events[e][n].apply(null,t);return this}};e.makeObserver=function(e){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n],e._events={})},e.makeObserver(e)}(),function(){$(window).on("pageshow",function(t){var n=sessionStorage._pageData&&JSON.parse(sessionStorage._pageData);n&&delete sessionStorage._pageData,e.trigger("pageShow",n),t.persisted?e.trigger("pageResume",n):"undefined"!=typeof n?e.trigger("pageResume",n):e.trigger("pageCreate")}),e.goBack=function(e,t){"undefined"!=typeof t&&(sessionStorage._pageData=JSON.stringify(t)),history.go(e||-1)},e.goTo=function(e,t){"undefined"!=typeof t&&(sessionStorage._pageData=JSON.stringify(t)),location.href=e}}(),e.isSupportStorage=function(){var e=!0;try{localStorage.test="test",delete localStorage.test}catch(t){e=!1}return e}(),e.script=function(){function e(e){if("undefined"!=typeof e){var t=document.createElement("script");t.innerHTML=e,document.body.appendChild(t),document.body.removeChild(t)}}function t(e,t){function r(){var r=$.Deferred();return n[e]={ver:t,deferred:r},$.ajax({url:e,type:"get",dataType:"text",cache:!1,timeout:5e3,success:function(i){var o={v:t,s:i};localStorage[e]=JSON.stringify(o),n[e].script=i,r.resolve(i)},error:function(t){delete n[e],t.status>=500?r.reject("服务器出去跑步了"):t.status>=400?r.reject("没找到页面"):r.reject("网络错误")}}),r}"undefined"==typeof t&&(t="0.0");var i=localStorage[e];if(i){if(i=JSON.parse(i),i.s&&i.v===t){var o=$.Deferred();return n[e]={ver:t,script:i.s,deferred:o},o.resolve(i.s)}return delete n[e],r()}return r()}var n={};return{load:function(){var r=[];return[].slice.call(arguments).forEach(function(e){var i=e[0],o=e[1]||"0.0";if(n[i]&&n[i].ver===o){var a=n[i].deferred;r.every(function(e){return e!==a})&&r.push(a)}else r.push(t(i,o))}),r.reduce(function(t,n){return t.then(function(){return n}).done(e)},$.Deferred().resolve())}}}(),e.obj2str=function(e){var t="";return $.each(e,function(e,n){t+="&"+e+"="+n}),t.substr(1)},e.str2obj=function(e){var t={};return e.split("&").forEach(function(e){var n=e.split("=");n[0]&&(t[n[0]]=n[1])}),t},e.getUrlObj=function(t){var n,r,i=document.createElement("a"),o={search:{},hash:{}};return i.href=t||location.href,n=i.search,r=i.hash,n&&(o.search=e.str2obj(n.substr(1))),r&&(o.hash=e.str2obj(r.substr(1))),o},e.lazyLoad=function(e){e.find("img[lazy-src]").each(function(e,t){var n=$(t),r=n.attr("lazy-src");if(r){var i=new Image;i.src=r,i.onload=function(){n.attr({src:r,"lazy-src":void 0})}}})},e.makeScrollLoader=function(t){function n(e){u=!0,o=e.touches[0].screenX,s=e.touches[0].screenY}function r(e){u&&(u=!1,i=e.touches[0].screenX-o,a=e.touches[0].screenY-s,p.checkFn({dx:i,dy:a})&&l.forEach(function(e){e()}))}var i,o,a,s,c,u=!1,p={root:$("body"),checkFn:function(){return!1},callback:null},d=e.debounce(r,300),l=[],f={start:function(){"on"!=c&&(c="on",p.root.on("touchstart",n).on("touchmove",d))},stop:function(){"off"!=c&&(c="off",p.root.off("touchstart",n).off("touchmove",d))},add:function(e){"function"==typeof e&&l.push(e)},del:function(e){"function"==typeof e&&l.every(function(t,n){return e===t?(delete l[n],!1):!0})},getState:function(){return c}};return $.extend(p,t),f.add(p.callback),f},e.getData=function(e,t,n){var r=0,i=1>n?1:n,o=$.Deferred(),a=function(){return s(e,t).done(function(e){o.resolve(e)}).fail(function(e){++r<i?a():o.reject(e)}),o.promise()},s=function(){var n=$.Deferred();return $.ajax({url:e,data:t,dataType:"jsonp",success:function(e){n.resolve(e)},error:function(){n.reject("服务器出去跑步了～")},timeout:5e3}),n.promise()};return a()},e.throttle=function(e,t,n){var r,i,o,a=null,s=0;n||(n={});var c=function(){s=n.leading===!1?0:+new Date,a=null,o=e.apply(r,i),a||(r=i=null)};return function(){var u=+new Date;s||n.leading!==!1||(s=u);var p=t-(u-s);return r=this,i=arguments,0>=p||p>t?(a&&(clearTimeout(a),a=null),s=u,o=e.apply(r,i),a||(r=i=null)):a||n.trailing===!1||(a=setTimeout(c,p)),o}},e.debounce=function(e,t,n){var r;return function(){var i=this,o=arguments,a=function(){r=null,n||e.apply(i,o)},s=n&&!r;clearTimeout(r),r=setTimeout(a,t),s&&e.apply(i,o)}},e.cookie=function(){function e(e){var t=new RegExp("(?:;)?"+encodeURIComponent(e)+"=([^;]*);?");return t.test(document.cookie)?decodeURIComponent(RegExp.$1):null}function t(e,t,n,r,i){n&&!isNaN(n)&&(n=new Date((new Date).getTime()+n)),document.cookie=e+"="+escape(t)+(n?"; expires="+n.toGMTString():"")+(r?"; path="+r:"; path=/")+(i?";domain="+i:"")}function n(e){document.cookie=encodeURIComponent(e)+"=0;expires=Fri, 02-Jan-1970 00:00:00 GMT;path=/"}return{get:e,set:t,del:n}}(),e.tmpl=function(){var e={};return function t(n,r){var i=/\W/.test(n)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+n.replace(/[\r\t\n]/g," ").split("<%").join("	").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("	").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):e[n]=e[n]||t(document.getElementById(n).innerHTML);return r?i(r):i}}(),e.Tabs=function(){this.init.apply(this,arguments)},$.extend(e.Tabs.prototype,{init:function(t,n,r){var i,o=this;n=n||".tab[data-type]",i=t.find(n),i.on("tap",function(){var e=$(this),t={index:+e.data("index"),type:e.data("type")};o.curType!=t.type&&(o.curType=t.type,o.trigger("tabChanged",t),"function"==typeof r?r&&r(t).then(function(){e.addClass("on").siblings().removeClass("on")}):e.addClass("on").siblings().removeClass("on"))}).each(function(e){$(this).data("index",e)}),this.curType=i.filter(".on").data("type"),this.container=t,this.tabs=i,e.makeObserver(this)},switchTo:function(e){this.tabs.filter("[data-type="+e+"]").trigger("tap")}}),function(){var t={maxLen:function(e,t){return e.length<=t},minLen:function(e,t){return e.length>=t},len:function(e,t){return e.length==+t},tel:function(e){return/^(0|86|17951)?(1[0-9]{2})[0-9]{8}$/.test(e)},idCard:function(e){return/^(([0-9]{17}[0-9X]{1})|([0-9]{15}))$/.test(e)},mail:function(e){return/^\w+([-+.]\w+)*@\w+([-.]\w+)*.\w+([-.]\w+)*$/.test(e)},zipCode:function(e){return/^[1-9]\d{5}(?!\d)$/.test(e)},nickName:function(e){return/^[a-zA-Z][a-zA-Z0-9_]{4,15}$/.test(e)},required:function(e){return e.length>0},number:function(e){return!/\D/.test(e)},password:function(e){return!/\W/.test(e)},gt:function(e,t){return Number(e)>t},lt:function(e,t){return Number(e)<t},gte:function(e,t){return Number(e)>=t},lte:function(e,t){return Number(e)<=t},beTrue:function(e){return!!e},beFalse:function(e){return!e}},n=function(e){var n=e.data("validate");if(!n||!n.trim().length)return!0;for(var r,i,o=n.split(","),a=o.length,s=e.val().trim();a-- >0;)if(r=o[a].split(":")[0],i=o[a].split(":")[1],i?(i=i.split("|"),i.unshift(s)):i=[s],!t[r]||!t[r].apply(null,i))return e[0].scrollIntoView&&e[0].scrollIntoView(),!1;return!0};e.Formfuc=function(){this.init.apply(this,arguments)},$.extend(e.Formfuc.prototype,{init:function(n,r){this.checkTypes="[data-validate]",this.cancelSubmit=!1,this.cancelValidate=!1,this.form=n,this.submitBtn=n.find("[data-type=submit]"),this.ckBtns=n.find("[data-type=checkBox]"),this.validateFns=$.extend(!0,{},t),this.errTarget=null,r&&$.extend(this,r);var i=this;this.submitBtn.on("tap",e.throttle(function(e){i.cancelSubmit||(i.cancelValidate||i.validate()?i.onSubmit():i.validateFail())},2e3,{trailing:!1})).on("click",function(e){!i.cancelSubmit&&e.preventDefault()}),this.ckBtns.on("tap",function(){$(this).toggleClass("on")})},validate:function(){var e=!0,t=this;return this.form.find(this.checkTypes).each(function(){var r=$(this);r.data("validate");return(e=n(r))?void(t.errTarget&&(t.errTarget.errTip.remove(),t.errTarget=null)):(t.errTarget||(t.errTarget=r),!1)}),e&&(t.errTarget=null),e},validateFail:function(){var e=this.errTarget;e.errTip?e.errTip.one("animationend webkitAnimationEnd",function(){e.removeClass("validateFailed")}).addClass("validateFailed"):(e.errTip=$('<div class="errTip">'+this.errTarget.data("msg")+"</div>"),this.errTarget.closest(".inputArea").append(e.errTip))},onSubmit:function(t){return e.getData(t).done(this.done).fail(this.fail)},addValidate:function(e,t){this.validates[e]||(this.validates[e]=t)}})}(),e.makeTip=function(e){function t(e){e.preventDefault()}var n={tpl:"",el:".txt",root:"body",duration:3e3,preventScroll:!1,fixAdBlock:!0},r=$.extend({},n,e),i=$(r.tpl),o=$(document.body),a=r.preventScroll,s=!1,c=r.fixAdBlock;return c&&i.css({position:"absolute",visibility:"hidden"}),{getEl:function(){return i},show:function(e,n,u){0!==i.length&&("function"==typeof this.done&&(this.done(),this.done=null),this._tid&&clearTimeout(this._tid),this.done=u,n=n>-1?n:r.duration,i.find(r.el).html(e),i.appendTo($(r.root)).show(),c&&setTimeout(function(){i.css({position:"fixed",visibility:"visible"})},10),n&&(this._tid=setTimeout(this.hide.bind(this),n)),a&&!s&&(s=!0,o.on("touchmove",t)))},hide:function(){c&&i.css({position:"absolute",visibility:"hidden"}),i.detach(),a&&s&&(o.off("touchmove",t),s=!1),"function"==typeof this.done&&(this.done(),this.done=null)}}},e.getLocation=function(e){var t=$.Deferred(),n={enableHighAccuracy:!0,timeout:1e4,maximumAge:2e3},r=e?$.extend({},n,e):n,i=setTimeout(function(){t.reject("请求用户地理位置超时")},1e4);return navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){clearTimeout(i),t.resolve(e)},function(e){switch(e.code){case e.PERMISSION_DENIED:t.reject("用户拒绝对获取地理位置的请求");break;case e.POSITION_UNAVAILABLE:t.reject("位置信息不可用");break;case e.TIMEOUT:t.reject("请求用户地理位置超时");break;case e.UNKNOWN_ERROR:t.reject("未知错误")}},r):t.reject("浏览器不支持获取位置信息"),t.promise()},e.padnumber=function(e,t){for(var n=e.toString().length;t>n;)e="0"+e,n++;return e},e.gTip=e.makeTip({tpl:'<div style="position:fixed;left:50%;top:50%;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);background-color:rgba(0,0,0,.5);z-index:200;padding:5px 15px;border-radius:3px;line-height:20px;color:white;font-size:16px;text-align:center;"><div class="txt"></div></div>'}),e.gModalTip=e.makeTip({tpl:'<div style="left:0px;top:0px;width:100%;height:100%;z-index:200;position:fixed;"><div class="gTip" style="position:absolute;left:50%;top:50%;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);background-color:rgba(0,0,0,.5);z-index:200;padding:5px 15px;border-radius:3px;line-height:20px;color:white;font-size:16px;text-align:center;"><div class="txt"></div></div></div>'}),e.gModalLoading=e.makeTip({tpl:'<div style="left:0px;top:0px;width:100%;height:100%;z-index:200;position:fixed;background:rgba(0, 0, 0, 0.5);"><div style="position:fixed;left:50%;top:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%, -50%);background-color:rgba(0, 0, 0, 0.5);z-index:201;padding:5px 15px;border-radius:3px;line-height:20px;color:white;font-size:16px;text-align:center;padding-left:20px;background:url(\'data:image/gif;base64,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\') no-repeat left center;background-size: 16px 16px;"><div class="txt"></div></div></div>'}),e.checkOs=function(t){if(document.write(decodeURI("%3Cscript src='//hm.baidu.com/h.js%3F57f7fa8376d0ddf63af2e6b149bd1595' type='text/javascript'%3E%3C/script%3E")),"runner"==t)var n="http://www.ledongli.cn",r="ldl://runner.ledongli.cn",i="ledonglirunner://",o="http://www.ledongli.cn/",a="http://www.ledongli.cn/",s="http://a.app.qq.com/o/simple.jsp?pkgname=cn.ledongli.runner";else var n="http://www.ledongli.cn",r="ldl://openapp.ledongli.com",i="ledongliopen://",o="http://www.ledongli.cn/",a="http://www.ledongli.cn/",s="http://a.app.qq.com/o/simple.jsp?pkgname=cn.ledongli.ldl";var c="",u="",p=navigator.userAgent||navigator.vendor||window.opera;if(null!=p){var d=p.toLowerCase();/android/i.test(d)?(c=r,u=s):/ip(hone|od)/i.test(d)?(c=i,u=s):/symbian/i.test(d)?(c=o,u=n):/windows (ce|phone)/i.test(d)?(c=a,u=n):(c=n,u=n)}else c=n,u=n;var l=new Date;window.location=c,setTimeout(function(){+new Date-l<2e3?(e.appInstalled=!1,e.url2Download=u,window.location=u):(e.appInstalled=!0,window.close())},500)},function(){function t(){var e=!0;try{window.sessionStorage.setItem("test001","test"),window.sessionStorage.removeItem("test001")}catch(t){e=!1}return e}function n(e){this.storageName=e}var r=e.session={};n.prototype.setData=function(e,t){if(e){var n=t||(new Date).getTime(),r={data:e,timestamp:n};window.sessionStorage.setItem(this.storageName,JSON.stringify(r))}},n.prototype.getData=function(e){var t=JSON.parse(window.sessionStorage.getItem(this.storageName));if(t){if(!e)return t.data;if(e==t.timestamp)return t.data}},n.prototype.clearData=function(){window.sessionStorage.removeItem(this.storageName)},n.prototype.setDataItem=function(e,t){var n=window.sessionStorage.getItem(this.storageName);n=n?JSON.parse(window.sessionStorage.getItem(this.storageName)):{timestamp:(new Date).getTime(),data:{}},n.data[e]=t,window.sessionStorage.setItem(this.storageName,JSON.stringify(n))},n.prototype.getDataItem=function(e){var t=this.getData();return t?t[e]:void 0},r.getSessionStorageInstance=function(e){var r=e||"LEDONGLI_051104";return t?new n(r):void 0}}(),function(){var t=e.getUrlObj().search;if("1"===t.debug&&$(window).on("error",function(e){alert(e.error.stack),console.log(e.error.stack)}),t.mock){e.app=e.app||{};var n=t.mock;"weixin"==n?(e.isWeixin=!0,e.isApp=!1):(e.isWeixin=!1,e.isApp=!0,e.app.name=n),e.userData={uid:7416,pc:"6a469906082f404f0979965a9a7184c136ebcaba",isLogin:1,src:e.app.name},$.extend(e.userData,t),e.loadAppJs=function r(){if(r.deferred)return r.deferred.promise();r.deferred=$.Deferred(),e.app=e.app||{};var t="login getAppInfo getUserInfo getWebCondition getActivitywithData setUserGoalWithData getDailyStatsWithData openURLWithData getCurrentLocation setWebViewShare openWithWebView launchWeChatPay updateShareModel tapUserinfo tapShare".split(" ");return t.forEach(function(t){e.app[t]=function(t){return function(n){return e.gTip.show(t+" excuted"),$.Deferred().resolve("{}")}}(t)}),e.app.getCurrentLocation=function(){var e=JSON.stringify({latitude:39.956074,longitude:116.310318});return $.Deferred().resolve(e)},e.app.openWithWebView=function(e){location.href=JSON.parse(e).url},e.app.getDailyStatsWithData=function(){var e=[1e3,2e3,5e3,6e3,8e3,1e4,15e3,18e3,2e4,3e4];return $.Deferred().resolve(JSON.stringify({DailyStats:[{pm2d5:0,report:[],distance:21.247860000000003,steps:e.sort(function(){return Math.random()>.5?1:-1})[0],date:1452096e3,calories:.9117826817849999,duration:0,lon:0,activeValue:322,lat:0}]}))},e.app.tapUserinfo=function(t){e.gTip.show("tapUserinfo excuted :"+JSON.parse(t).uid)},setTimeout(function(){r.deferred.resolve()},500),r.deferred.promise()},e.getUserDataInapp=function(){return e.loadAppJs()},e.getUserDataInWeixin=function(){return $.Deferred().resolve()}}}(),e.isApp&&e.loadAppJs()}(),function(){var e="prod",t={test:{},staging:{},prod:{}};$.extend(window.ldl,t[e]),ldl.curEnv=e}();
//# sourceMappingURL=../map/lib/common.js.map
